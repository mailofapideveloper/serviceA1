<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<l7:Bundle xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management">
    <l7:References>
        <l7:Item>
            <l7:Name>Portal Service Preface</l7:Name>
            <l7:Id>655d6ebecd5b405fa9cb192a29d8ec55</l7:Id>
            <l7:Type>POLICY</l7:Type>
            <l7:TimeStamp>2023-07-20T12:13:39.877-05:00</l7:TimeStamp>
            <l7:Resource>
                <l7:Policy guid="812ed196-c315-4e92-b630-b5c64c5c043c" id="655d6ebecd5b405fa9cb192a29d8ec55" version="15">
                    <l7:PolicyDetail folderId="b4bff64ea3a845db60b78151a87dbfb3" guid="812ed196-c315-4e92-b630-b5c64c5c043c" id="655d6ebecd5b405fa9cb192a29d8ec55" version="15">
                        <l7:Name>Portal Service Preface</l7:Name>
                        <l7:PolicyType>Include</l7:PolicyType>
                        <l7:Properties>
                            <l7:Property key="hasRouting">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                            <l7:Property key="revision">
                                <l7:LongValue>16</l7:LongValue>
                            </l7:Property>
                            <l7:Property key="soap">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                        </l7:Properties>
                    </l7:PolicyDetail>
                    <l7:Resources>
                        <l7:ResourceSet tag="policy">
                            <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
    &lt;wsp:All wsp:Usage="Required"&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${service.property.internal.portalAPIEnabled}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:ExpressionIsVariable booleanValue="false"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:Operator operator="EMPTY"/&gt;
                            &lt;L7p:RightValue stringValue=""/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${service.property.internal.portalAPIEnabled}"/&gt;
                    &lt;L7p:Expression2 stringValue="true"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:RightValue stringValue="true"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
            &lt;/wsp:OneOrMore&gt;
            &lt;L7p:FalseAssertion/&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="check portal state"/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="https://${request.http.header.host}"/&gt;
                    &lt;L7p:ExpressionIsVariable booleanValue="false"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="string"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:RightValue stringValue="${request.http.header.origin}"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:CORS&gt;
                    &lt;L7p:AcceptedMethods stringListValue="included"&gt;
                        &lt;L7p:item stringValue="GET"/&gt;
                        &lt;L7p:item stringValue="PUT"/&gt;
                        &lt;L7p:item stringValue="POST"/&gt;
                        &lt;L7p:item stringValue="HEAD"/&gt;
                        &lt;L7p:item stringValue="DELETE"/&gt;
                        &lt;L7p:item stringValue="PATCH"/&gt;
                        &lt;L7p:item stringValue="OPTIONS"/&gt;
                    &lt;/L7p:AcceptedMethods&gt;
                    &lt;L7p:AllowNonStandardMethods booleanValue="true"/&gt;
                    &lt;L7p:RequireCors booleanValue="false"/&gt;
                &lt;/L7p:CORS&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:CORS&gt;
                &lt;L7p:AcceptedMethods stringListValue="included"&gt;
                    &lt;L7p:item stringValue="GET"/&gt;
                    &lt;L7p:item stringValue="PUT"/&gt;
                    &lt;L7p:item stringValue="POST"/&gt;
                    &lt;L7p:item stringValue="HEAD"/&gt;
                    &lt;L7p:item stringValue="DELETE"/&gt;
                    &lt;L7p:item stringValue="PATCH"/&gt;
                    &lt;L7p:item stringValue="OPTIONS"/&gt;
                &lt;/L7p:AcceptedMethods&gt;
                &lt;L7p:AcceptedOrigins stringListValue="included"&gt;
                    &lt;L7p:item stringValue="http://coreportal.w2capl0055711.heb.com"/&gt;
                    &lt;L7p:item stringValue="https://coreportal.w2capl0055711.heb.com"/&gt;
                    &lt;L7p:item stringValue="https://fleet.df.nonprod.gcp.heb.com"/&gt;
                    &lt;L7p:item stringValue="https://make-ready.nonprod.heb.com"/&gt;
                &lt;/L7p:AcceptedOrigins&gt;
                &lt;L7p:AllowNonStandardMethods booleanValue="true"/&gt;
                &lt;L7p:RequireCors booleanValue="false"/&gt;
            &lt;/L7p:CORS&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${cors.isCORS}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="boolean"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:RightValue stringValue="false"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${cors.isPreflight}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="boolean"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:RightValue stringValue="false"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
            &lt;/wsp:OneOrMore&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:CustomizeErrorResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                        &lt;L7p:Properties mapValue="included"&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="// return immediately with a 200 response"/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Content stringValue=""/&gt;
                    &lt;L7p:ExtraHeaders nameValuePairArray="included"/&gt;
                    &lt;L7p:HttpStatus stringValue="200"/&gt;
                &lt;/L7p:CustomizeErrorResponse&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="// is cors preflight request"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="//process cors result if any"/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                        </l7:ResourceSet>
                    </l7:Resources>
                </l7:Policy>
            </l7:Resource>
        </l7:Item>
        <l7:Item>
            <l7:Name>Tibco IPs</l7:Name>
            <l7:Id>5f835cde51f5225f62394e8096c3e6e8</l7:Id>
            <l7:Type>POLICY</l7:Type>
            <l7:TimeStamp>2023-07-20T12:13:39.883-05:00</l7:TimeStamp>
            <l7:Resource>
                <l7:Policy guid="d118492b-249b-483f-aa3a-93f2ec1685bd" id="5f835cde51f5225f62394e8096c3e6e8" version="1">
                    <l7:PolicyDetail folderId="bf814e308b5a7ca01522e3ee189aa7d3" guid="d118492b-249b-483f-aa3a-93f2ec1685bd" id="5f835cde51f5225f62394e8096c3e6e8" version="1">
                        <l7:Name>Tibco IPs</l7:Name>
                        <l7:PolicyType>Include</l7:PolicyType>
                        <l7:Properties>
                            <l7:Property key="hasRouting">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                            <l7:Property key="revision">
                                <l7:LongValue>2</l7:LongValue>
                            </l7:Property>
                            <l7:Property key="soap">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                        </l7:Properties>
                    </l7:PolicyDetail>
                    <l7:Resources>
                        <l7:ResourceSet tag="policy">
                            <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
    &lt;wsp:All wsp:Usage="Required"&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="Policy Fragment: Tibco IPs"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.26"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.28"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.34"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.36"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.43"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server(172.28.55.44,172.28.55.45)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="31"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.44"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.49"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.51"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.63"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.65"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Servers(172.28.55.66,172.28.55.67)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="31"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.66"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server(172.28.55.68,172.28.55.69)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="31"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.68"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.70"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.75"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.76"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Servers(172.28.55.78,172.28.55.79)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="31"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.78"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Servers with IP's(172.28.55.80,172.28.55.81,172.28.55.82,172.28.55.83)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="30"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.80"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.84"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server(172.28.55.88,172.28.55.89)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="31"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.88"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.90"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Servers(172.28.55.248,172.28.55.249)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="31"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.248"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server(172.28.63.42,172.28.63.43)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="31"/&gt;
                &lt;L7p:StartIp stringValue="172.28.63.42"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server(172.28.63.44,172.28.63.45)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="31"/&gt;
                &lt;L7p:StartIp stringValue="172.28.63.44"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server(172.28.68.64,172.28.68.65)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="31"/&gt;
                &lt;L7p:StartIp stringValue="172.28.68.64"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server(172.28.68.64,172.28.68.65)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.68.69"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server(172.28.68.64,172.28.68.65)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.68.70"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server(172.28.68.64,172.28.68.65)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.68.73"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server(172.28.68.64,172.28.68.65)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="31"/&gt;
                &lt;L7p:StartIp stringValue="172.28.68.74"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server(172.28.68.64,172.28.68.65)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.68.76"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.112.63"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Servers(172.28.112.64,172.28.112.65)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="31"/&gt;
                &lt;L7p:StartIp stringValue="172.28.112.64"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.112.66"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server(172.28.187.16,172.28.187.17)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="31"/&gt;
                &lt;L7p:StartIp stringValue="172.28.187.16"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.208.15"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.208.17"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server(172.28.208.18,172.28.208.19)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="31"/&gt;
                &lt;L7p:StartIp stringValue="172.28.208.18"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.208.23"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server (172.28.208.24,172.28.208.25)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="31"/&gt;
                &lt;L7p:StartIp stringValue="172.28.208.24"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.208.26"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue="Below are Cert IP's"/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.37.20"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.53.19"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.53.20"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Servers(172.28.55.24,172.28.55.25)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="31"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.24"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.37.30"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Servers(172.28.37.50,172.28.37.51)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="31"/&gt;
                &lt;L7p:StartIp stringValue="172.28.37.50"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server(172.28.37.52,172.28.37.53,172.28.37.54,172.28.37.55)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="30"/&gt;
                &lt;L7p:StartIp stringValue="172.28.37.52"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Servers(172.28.37.56 to 172.28.37.63)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="29"/&gt;
                &lt;L7p:StartIp stringValue="172.28.37.56"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Servers(172.28.37.84,172.28.37.85,172.28.37.86,172.28.37.87)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="30"/&gt;
                &lt;L7p:StartIp stringValue="172.28.37.84"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Servers(172.28.37.88,172.28.37.89,172.28.37.90,172.28.37.91,172.28.37.92,172.28.37.93,172.28.37.94,172.28.37.95)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="29"/&gt;
                &lt;L7p:StartIp stringValue="172.28.37.88"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.205"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.224"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.226"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server(172.28.116.196,172.28.116.197,172.28.116.198,172.28.116.199)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="30"/&gt;
                &lt;L7p:StartIp stringValue="172.28.116.196"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.187.125"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.187.127"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.12"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
            &lt;L7p:RemoteIpAddressRange&gt;
                &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Allow access to Tibco Server"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:NetworkMask stringValue="32"/&gt;
                &lt;L7p:StartIp stringValue="172.28.55.22"/&gt;
            &lt;/L7p:RemoteIpAddressRange&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                        </l7:ResourceSet>
                    </l7:Resources>
                </l7:Policy>
            </l7:Resource>
        </l7:Item>
        <l7:Item>
            <l7:Name>Account Plans Fragment</l7:Name>
            <l7:Id>b4bff64ea3a845db60b78151a87dc16f</l7:Id>
            <l7:Type>POLICY</l7:Type>
            <l7:TimeStamp>2023-07-20T12:13:39.900-05:00</l7:TimeStamp>
            <l7:Resource>
                <l7:Policy guid="f8a5669d-831e-4417-9225-f52527f90323" id="b4bff64ea3a845db60b78151a87dc16f" version="1541">
                    <l7:PolicyDetail folderId="b4bff64ea3a845db60b78151a87dbfb3" guid="f8a5669d-831e-4417-9225-f52527f90323" id="b4bff64ea3a845db60b78151a87dc16f" version="1541">
                        <l7:Name>Account Plans Fragment</l7:Name>
                        <l7:PolicyType>Include</l7:PolicyType>
                        <l7:Properties>
                            <l7:Property key="hasRouting">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                            <l7:Property key="revision">
                                <l7:LongValue>1542</l7:LongValue>
                            </l7:Property>
                            <l7:Property key="soap">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                        </l7:Properties>
                    </l7:PolicyDetail>
                    <l7:Resources>
                        <l7:ResourceSet tag="policy">
                            <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
    &lt;wsp:All wsp:Usage="Required"&gt;
        &lt;L7p:AuditDetailAssertion&gt;
            &lt;L7p:Detail stringValue="Policy Fragment: Account Plans Fragment"/&gt;
            &lt;L7p:LoggingOnly booleanValue="true"/&gt;
        &lt;/L7p:AuditDetailAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="// This fragment is auto generated by the gateway. DO NOT MODIFY"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue="JHthcGlLZXl9"/&gt;
            &lt;L7p:VariableToSet stringValue="apiKey"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue="JHthY2NvdW50UGxhbk1hcHBpbmdJZH0="/&gt;
            &lt;L7p:VariableToSet stringValue="accountPlanMappingId"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue="ZmFsc2U="/&gt;
            &lt;L7p:VariableToSet stringValue="apiAuthz"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue="Tm90IFNldA=="/&gt;
            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${accountPlanMappingId}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="string"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Negated booleanValue="true"/&gt;
                            &lt;L7p:Operator operator="EMPTY"/&gt;
                            &lt;L7p:RightValue stringValue=""/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${apiAuthzDetails}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="string"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:RightValue stringValue="Not Set"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=""/&gt;
                            &lt;L7p:VariableToSet stringValue="orgIds"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:Split&gt;
                            &lt;L7p:IgnoreEmptyValues booleanValue="true"/&gt;
                            &lt;L7p:InputVariable stringValue="orgIds"/&gt;
                            &lt;L7p:OutputVariable stringValue="orgIdsSplit"/&gt;
                        &lt;/L7p:Split&gt;
                        &lt;L7p:IndexLookupByItem&gt;
                            &lt;L7p:MultivaluedVariableName stringValue="orgIdsSplit"/&gt;
                            &lt;L7p:OutputVariableName stringValue="matchIndex"/&gt;
                            &lt;L7p:ValueToSearchForVariableName stringValue="accountPlanMappingId"/&gt;
                        &lt;/L7p:IndexLookupByItem&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="MDhkY2YwMjQtNzAwOS00ZDk5LWE0Y2YtOGJhY2VhYzhhZTA0"/&gt;
                    &lt;L7p:VariableToSet stringValue="accountPlanId"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="VGVzdCBBY2NvdW50IFBsYW4="/&gt;
                    &lt;L7p:VariableToSet stringValue="accountPlanName"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9fCR7YXBpS2V5fXwke2FjY291bnRQbGFuTWFwcGluZ0lkfXxxdW90YT8="/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="MA=="/&gt;
                            &lt;L7p:VariableToSet stringValue="quota"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=""/&gt;
                            &lt;L7p:VariableToSet stringValue="timeUnit"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:ThroughputQuota&gt;
                            &lt;L7p:CounterName stringValue="${accountPlanMappingId}"/&gt;
                            &lt;L7p:CounterStrategy intValue="0"/&gt;
                            &lt;L7p:Enabled booleanValue="false"/&gt;
                            &lt;L7p:Global booleanValue="true"/&gt;
                            &lt;L7p:Quota stringValue="${quota}"/&gt;
                            &lt;L7p:ReadSynchronous booleanValue="false"/&gt;
                            &lt;L7p:Synchronous booleanValue="false"/&gt;
                            &lt;L7p:TimeUnit stringValue="day"/&gt;
                        &lt;/L7p:ThroughputQuota&gt;
                        &lt;L7p:RateLimit&gt;
                            &lt;L7p:CounterName stringValue="${accountPlanMappingId}"/&gt;
                            &lt;L7p:Enabled booleanValue="false"/&gt;
                            &lt;L7p:WindowSizeInSeconds stringValue="0"/&gt;
                        &lt;/L7p:RateLimit&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9b2t8cmF0ZT8="/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="dHJ1ZQ=="/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthz"/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9ZmFpbGVk"/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Test Account Plan:08dcf024-7009-4d99-a4cf-8baceac8ae04"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${accountPlanMappingId}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="string"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Negated booleanValue="true"/&gt;
                            &lt;L7p:Operator operator="EMPTY"/&gt;
                            &lt;L7p:RightValue stringValue=""/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${apiAuthzDetails}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="string"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:RightValue stringValue="Not Set"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="MDNjZWEyNDctZGRiNS00NjY3LWI0ZmEtMjk2ODg0MmMzMjcwLDBmMjM5YTU4LWY1NTEtNGE4Zi04NDliLWJlZjMxOWZkNTcyZSwyMDM3NjQ4Yy1iNWIxLTQ2OTktOGI3Ni0zYWEyNjVmNDE1YTcsMjc1ZjBiYTYtZjc3Yy00NjU5LWI4N2UtNGI4MDgwOTMxODdiLDJkODY0NDg0LWUwOGMtNDM5NS1hZDAzLWY2YjhjOWQ2ZjcxZiwyZTZhZDZhMC0yYjkwLTQyYTEtYTE0MS1jMzVkMTI0NzVhNzUsNWNlOWM1ZGQtNWZmOS00NDU5LTg4MzUtZTA1MjI4MjU1NzhmLDY1NjgwYTdmLWJjMGQtNGRkZC1hMjMzLWNmNjM2MTkyZWUyNCw4MDE0NzJkYi0zNzhhLTQ1NDAtYWQ2ZS04ZDUxN2M1MGFhMzAsOTI0NjIzMWEtZDgyOC00YzI1LTk1ZGItZTMyN2RhYmVhMjgyLDliMWMwODNiLTBjYjItNDEzMS05NmQxLTI1ZWZhNjQ3MTU5NCxhOTFmZjgzNC0xYmIyLTQ3MGQtYTE1Zi02OGE0YTkyMzUwNWUsZGNhYjAxODUtYWYyZC00MjdjLWExMmQtODkwOTQ3YTA1MmY4LGU2YzkzMTc2LTk0MTAtNGY3NS04ZWVmLTdhODdlZTMyN2E4MSxmYmE3NjA1YS1iNjEwLTQyZjMtYTMyYS05YmE4MzVkY2FkZGIsZmZjYzY4N2EtMzg1Zi00ZjRlLWE1NWYtYmM3NTRkMzlmZjFh"/&gt;
                            &lt;L7p:VariableToSet stringValue="orgIds"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:Split&gt;
                            &lt;L7p:IgnoreEmptyValues booleanValue="true"/&gt;
                            &lt;L7p:InputVariable stringValue="orgIds"/&gt;
                            &lt;L7p:OutputVariable stringValue="orgIdsSplit"/&gt;
                        &lt;/L7p:Split&gt;
                        &lt;L7p:IndexLookupByItem&gt;
                            &lt;L7p:MultivaluedVariableName stringValue="orgIdsSplit"/&gt;
                            &lt;L7p:OutputVariableName stringValue="matchIndex"/&gt;
                            &lt;L7p:ValueToSearchForVariableName stringValue="accountPlanMappingId"/&gt;
                        &lt;/L7p:IndexLookupByItem&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="Njk5NzE4OWItZTJmMS00MDVkLTliZGItNDdiY2U2NzU4N2Zm"/&gt;
                    &lt;L7p:VariableToSet stringValue="accountPlanId"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="U3RhbmRhcmQgVUFUIEFjY291bnQgUGxhbg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="accountPlanName"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9fCR7YXBpS2V5fXwke2FjY291bnRQbGFuTWFwcGluZ0lkfXxxdW90YT8="/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="MA=="/&gt;
                            &lt;L7p:VariableToSet stringValue="quota"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=""/&gt;
                            &lt;L7p:VariableToSet stringValue="timeUnit"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:ThroughputQuota&gt;
                            &lt;L7p:CounterName stringValue="${accountPlanMappingId}"/&gt;
                            &lt;L7p:CounterStrategy intValue="0"/&gt;
                            &lt;L7p:Enabled booleanValue="false"/&gt;
                            &lt;L7p:Global booleanValue="true"/&gt;
                            &lt;L7p:Quota stringValue="${quota}"/&gt;
                            &lt;L7p:ReadSynchronous booleanValue="false"/&gt;
                            &lt;L7p:Synchronous booleanValue="false"/&gt;
                            &lt;L7p:TimeUnit stringValue="day"/&gt;
                        &lt;/L7p:ThroughputQuota&gt;
                        &lt;L7p:RateLimit&gt;
                            &lt;L7p:CounterName stringValue="${accountPlanMappingId}"/&gt;
                            &lt;L7p:Enabled booleanValue="false"/&gt;
                            &lt;L7p:WindowSizeInSeconds stringValue="0"/&gt;
                        &lt;/L7p:RateLimit&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9b2t8cmF0ZT8="/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="dHJ1ZQ=="/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthz"/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9ZmFpbGVk"/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Standard UAT Account Plan:6997189b-e2f1-405d-9bdb-47bce67587ff"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${accountPlanMappingId}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="string"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Negated booleanValue="true"/&gt;
                            &lt;L7p:Operator operator="EMPTY"/&gt;
                            &lt;L7p:RightValue stringValue=""/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${apiAuthzDetails}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="string"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:RightValue stringValue="Not Set"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=""/&gt;
                            &lt;L7p:VariableToSet stringValue="orgIds"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:Split&gt;
                            &lt;L7p:IgnoreEmptyValues booleanValue="true"/&gt;
                            &lt;L7p:InputVariable stringValue="orgIds"/&gt;
                            &lt;L7p:OutputVariable stringValue="orgIdsSplit"/&gt;
                        &lt;/L7p:Split&gt;
                        &lt;L7p:IndexLookupByItem&gt;
                            &lt;L7p:MultivaluedVariableName stringValue="orgIdsSplit"/&gt;
                            &lt;L7p:OutputVariableName stringValue="matchIndex"/&gt;
                            &lt;L7p:ValueToSearchForVariableName stringValue="accountPlanMappingId"/&gt;
                        &lt;/L7p:IndexLookupByItem&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="NjllZmRmZjUtOTE4YS00MmMzLWE4YmYtYTAyMjI3ZTQ3NzVi"/&gt;
                    &lt;L7p:VariableToSet stringValue="accountPlanId"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="SW50ZXJuYWwgUGxhbg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="accountPlanName"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9fCR7YXBpS2V5fXwke2FjY291bnRQbGFuTWFwcGluZ0lkfXxxdW90YT8="/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="MA=="/&gt;
                            &lt;L7p:VariableToSet stringValue="quota"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=""/&gt;
                            &lt;L7p:VariableToSet stringValue="timeUnit"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:ThroughputQuota&gt;
                            &lt;L7p:CounterName stringValue="${accountPlanMappingId}"/&gt;
                            &lt;L7p:CounterStrategy intValue="0"/&gt;
                            &lt;L7p:Enabled booleanValue="false"/&gt;
                            &lt;L7p:Global booleanValue="true"/&gt;
                            &lt;L7p:Quota stringValue="${quota}"/&gt;
                            &lt;L7p:ReadSynchronous booleanValue="false"/&gt;
                            &lt;L7p:Synchronous booleanValue="false"/&gt;
                            &lt;L7p:TimeUnit stringValue="day"/&gt;
                        &lt;/L7p:ThroughputQuota&gt;
                        &lt;L7p:RateLimit&gt;
                            &lt;L7p:CounterName stringValue="${accountPlanMappingId}"/&gt;
                            &lt;L7p:Enabled booleanValue="false"/&gt;
                            &lt;L7p:WindowSizeInSeconds stringValue="0"/&gt;
                        &lt;/L7p:RateLimit&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9b2t8cmF0ZT8="/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="dHJ1ZQ=="/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthz"/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9ZmFpbGVk"/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Internal Plan:69efdff5-918a-42c3-a8bf-a02227e4775b"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${accountPlanMappingId}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="string"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Negated booleanValue="true"/&gt;
                            &lt;L7p:Operator operator="EMPTY"/&gt;
                            &lt;L7p:RightValue stringValue=""/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${apiAuthzDetails}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="string"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:RightValue stringValue="Not Set"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=""/&gt;
                            &lt;L7p:VariableToSet stringValue="orgIds"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:Split&gt;
                            &lt;L7p:IgnoreEmptyValues booleanValue="true"/&gt;
                            &lt;L7p:InputVariable stringValue="orgIds"/&gt;
                            &lt;L7p:OutputVariable stringValue="orgIdsSplit"/&gt;
                        &lt;/L7p:Split&gt;
                        &lt;L7p:IndexLookupByItem&gt;
                            &lt;L7p:MultivaluedVariableName stringValue="orgIdsSplit"/&gt;
                            &lt;L7p:OutputVariableName stringValue="matchIndex"/&gt;
                            &lt;L7p:ValueToSearchForVariableName stringValue="accountPlanMappingId"/&gt;
                        &lt;/L7p:IndexLookupByItem&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="OGYwMzAwYTUtOWUyMC00MzQ1LTllMDAtMTkxMzNjMmM3YjJk"/&gt;
                    &lt;L7p:VariableToSet stringValue="accountPlanId"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="UGFydG5lciBQbGFu"/&gt;
                    &lt;L7p:VariableToSet stringValue="accountPlanName"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9fCR7YXBpS2V5fXwke2FjY291bnRQbGFuTWFwcGluZ0lkfXxxdW90YT8="/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="MA=="/&gt;
                            &lt;L7p:VariableToSet stringValue="quota"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=""/&gt;
                            &lt;L7p:VariableToSet stringValue="timeUnit"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:ThroughputQuota&gt;
                            &lt;L7p:CounterName stringValue="${accountPlanMappingId}"/&gt;
                            &lt;L7p:CounterStrategy intValue="0"/&gt;
                            &lt;L7p:Enabled booleanValue="false"/&gt;
                            &lt;L7p:Global booleanValue="true"/&gt;
                            &lt;L7p:Quota stringValue="${quota}"/&gt;
                            &lt;L7p:ReadSynchronous booleanValue="false"/&gt;
                            &lt;L7p:Synchronous booleanValue="false"/&gt;
                            &lt;L7p:TimeUnit stringValue="day"/&gt;
                        &lt;/L7p:ThroughputQuota&gt;
                        &lt;L7p:RateLimit&gt;
                            &lt;L7p:CounterName stringValue="${accountPlanMappingId}"/&gt;
                            &lt;L7p:Enabled booleanValue="false"/&gt;
                            &lt;L7p:WindowSizeInSeconds stringValue="0"/&gt;
                        &lt;/L7p:RateLimit&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9b2t8cmF0ZT8="/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="dHJ1ZQ=="/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthz"/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9ZmFpbGVk"/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Partner Plan:8f0300a5-9e20-4345-9e00-19133c2c7b2d"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${accountPlanMappingId}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="string"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Negated booleanValue="true"/&gt;
                            &lt;L7p:Operator operator="EMPTY"/&gt;
                            &lt;L7p:RightValue stringValue=""/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${apiAuthzDetails}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="string"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:RightValue stringValue="Not Set"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:TrueAssertion/&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="MmY4YWRhN2UtOGE4MC00NGM1LTg5ODAtNDExOGQ1ZjU1MDBh"/&gt;
                    &lt;L7p:VariableToSet stringValue="accountPlanId"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="QnJvbnplIEFjY291bnQgUGxhbg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="accountPlanName"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9fCR7YXBpS2V5fXwke2FjY291bnRQbGFuTWFwcGluZ0lkfXxxdW90YT8="/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="MA=="/&gt;
                            &lt;L7p:VariableToSet stringValue="quota"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=""/&gt;
                            &lt;L7p:VariableToSet stringValue="timeUnit"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:ThroughputQuota&gt;
                            &lt;L7p:CounterName stringValue="${accountPlanMappingId}"/&gt;
                            &lt;L7p:CounterStrategy intValue="0"/&gt;
                            &lt;L7p:Enabled booleanValue="false"/&gt;
                            &lt;L7p:Global booleanValue="true"/&gt;
                            &lt;L7p:Quota stringValue="${quota}"/&gt;
                            &lt;L7p:ReadSynchronous booleanValue="false"/&gt;
                            &lt;L7p:Synchronous booleanValue="false"/&gt;
                            &lt;L7p:TimeUnit stringValue="day"/&gt;
                        &lt;/L7p:ThroughputQuota&gt;
                        &lt;L7p:RateLimit&gt;
                            &lt;L7p:CounterName stringValue="${accountPlanMappingId}"/&gt;
                            &lt;L7p:Enabled booleanValue="false"/&gt;
                            &lt;L7p:WindowSizeInSeconds stringValue="0"/&gt;
                        &lt;/L7p:RateLimit&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9b2t8cmF0ZT8="/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="dHJ1ZQ=="/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthz"/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9ZmFpbGVk"/&gt;
                            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Bronze Account Plan:2f8ada7e-8a80-44c5-8980-4118d5f5500a(Default)"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${apiAuthzDetails}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="string"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:RightValue stringValue="Not Set"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="ZmFsc2U="/&gt;
                    &lt;L7p:VariableToSet stringValue="apiAuthz"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHthcGlLZXl9fCR7YWNjb3VudFBsYW5NYXBwaW5nSWR9IEFjY291bnRQbGFuTWFwcGluZ0lkIG5vdCBmb3VuZA=="/&gt;
                    &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="//accountPlanMappingId not found"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="Updated on Thu Apr 06 07:00:00 CDT 2023"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:ExportVariables&gt;
            &lt;L7p:ExportedVars stringArrayValue="included"&gt;
                &lt;L7p:item stringValue="apiAuthz"/&gt;
                &lt;L7p:item stringValue="apiAuthzDetails"/&gt;
                &lt;L7p:item stringValue="accountPlanId"/&gt;
                &lt;L7p:item stringValue="accountPlanName"/&gt;
                &lt;L7p:item stringValue="quota"/&gt;
                &lt;L7p:item stringValue="timeUnit"/&gt;
            &lt;/L7p:ExportedVars&gt;
        &lt;/L7p:ExportVariables&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                        </l7:ResourceSet>
                    </l7:Resources>
                </l7:Policy>
            </l7:Resource>
        </l7:Item>
        <l7:Item>
            <l7:Name>API Plans Traffic Enforcement Fragment</l7:Name>
            <l7:Id>b4bff64ea3a845db60b78151a87dc05e</l7:Id>
            <l7:Type>POLICY</l7:Type>
            <l7:TimeStamp>2023-07-20T12:13:39.904-05:00</l7:TimeStamp>
            <l7:Resource>
                <l7:Policy guid="f8a5669d-831e-4417-9225-f52527f90212" id="b4bff64ea3a845db60b78151a87dc05e" version="9">
                    <l7:PolicyDetail folderId="b4bff64ea3a845db60b78151a87dbfb3" guid="f8a5669d-831e-4417-9225-f52527f90212" id="b4bff64ea3a845db60b78151a87dc05e" version="9">
                        <l7:Name>API Plans Traffic Enforcement Fragment</l7:Name>
                        <l7:PolicyType>Include</l7:PolicyType>
                        <l7:Properties>
                            <l7:Property key="hasRouting">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                            <l7:Property key="revision">
                                <l7:LongValue>9</l7:LongValue>
                            </l7:Property>
                            <l7:Property key="soap">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                        </l7:Properties>
                    </l7:PolicyDetail>
                    <l7:Resources>
                        <l7:ResourceSet tag="policy">
                            <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
    &lt;wsp:All wsp:Usage="Required"&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue="ZmFsc2U="/&gt;
            &lt;L7p:VariableToSet stringValue="apiAuthz"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue="Tm90IFNldA=="/&gt;
            &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtwb3J0YWwubWFuYWdlZC5zZXJ2aWNlLmFwaUlkfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="apiId"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:AssertionComment assertionComment="included"&gt;
                            &lt;L7p:Properties mapValue="included"&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                    &lt;L7p:value stringValue="// Skip API Plan lookup for unit testing"/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:AssertionComment&gt;
                        &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                        &lt;L7p:Expression1 stringValue="${api.plans.traffic.enforce.skip.lookup}"/&gt;
                        &lt;L7p:MultivaluedComparison multivaluedComparison="FIRST"/&gt;
                        &lt;L7p:Operator operatorNull="null"/&gt;
                        &lt;L7p:Predicates predicates="included"&gt;
                            &lt;L7p:item dataType="included"&gt;
                                &lt;L7p:Type variableDataType="boolean"/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary="included"&gt;
                                &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                &lt;L7p:RightValue stringValue="true"/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:Encapsulated&gt;
                        &lt;L7p:EncapsulatedAssertionConfigGuid stringValue="18fee60c-88aa-4551-b197-602e9abd5996"/&gt;
                        &lt;L7p:EncapsulatedAssertionConfigName stringValue="API Plan Lookup"/&gt;
                    &lt;/L7p:Encapsulated&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9fCR7YXBpS2V5fXwke2FjY291bnRQbGFuTWFwcGluZ0lkfXxxdW90YT8="/&gt;
                    &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="MA=="/&gt;
                    &lt;L7p:VariableToSet stringValue="quota"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtsb29rdXAudGltZXVuaXR9"/&gt;
                    &lt;L7p:VariableToSet stringValue="timeUnit"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:Encapsulated&gt;
                    &lt;L7p:EncapsulatedAssertionConfigGuid stringValue="c76b0b8a-364b-4a14-b232-1aaafb210da2"/&gt;
                    &lt;L7p:EncapsulatedAssertionConfigName stringValue="Portal Require API Plan"/&gt;
                    &lt;L7p:Parameters mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="apiId"/&gt;
                            &lt;L7p:value stringValue="${portal.managed.service.apiId}"/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="apiKey"/&gt;
                            &lt;L7p:value stringValue="${request.http.parameter.apikey}"/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="quota"/&gt;
                            &lt;L7p:value stringValue="${lookup.quota}"/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="ratelimit"/&gt;
                            &lt;L7p:value stringValue="${lookup.maxrequestrate}"/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="timeUnit"/&gt;
                            &lt;L7p:value stringValue="${timeUnit}"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Parameters&gt;
                &lt;/L7p:Encapsulated&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9b2t8cmF0ZT8="/&gt;
                    &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="dHJ1ZQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="apiAuthz"/&gt;
                &lt;/L7p:SetVariable&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                        &lt;L7p:Expression1 stringValue="${error.code}"/&gt;
                        &lt;L7p:Operator operatorNull="null"/&gt;
                        &lt;L7p:Predicates predicates="included"&gt;
                            &lt;L7p:item dataType="included"&gt;
                                &lt;L7p:Type variableDataType="int"/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary="included"&gt;
                                &lt;L7p:RightValue stringValue="0"/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9JHtlcnJvci5tc2d9"/&gt;
                        &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                    &lt;/L7p:SetVariable&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHthcGlBdXRoekRldGFpbHN9ZmFpbGVk"/&gt;
                    &lt;L7p:VariableToSet stringValue="apiAuthzDetails"/&gt;
                &lt;/L7p:SetVariable&gt;
            &lt;/wsp:All&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:ExportVariables&gt;
            &lt;L7p:ExportedVars stringArrayValue="included"&gt;
                &lt;L7p:item stringValue="apiAuthz"/&gt;
                &lt;L7p:item stringValue="apiAuthzDetails"/&gt;
                &lt;L7p:item stringValue="quota"/&gt;
                &lt;L7p:item stringValue="timeUnit"/&gt;
            &lt;/L7p:ExportedVars&gt;
        &lt;/L7p:ExportVariables&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                        </l7:ResourceSet>
                    </l7:Resources>
                </l7:Policy>
            </l7:Resource>
        </l7:Item>
        <l7:Item>
            <l7:Name>Remove Org</l7:Name>
            <l7:Id>fab70e93841614f8f7afa0ce880ae52d</l7:Id>
            <l7:Type>POLICY</l7:Type>
            <l7:TimeStamp>2023-07-20T12:13:39.905-05:00</l7:TimeStamp>
            <l7:Resource>
                <l7:Policy guid="72847008-0b74-44d5-a0e9-86c25c2fdbca" id="fab70e93841614f8f7afa0ce880ae52d" version="0">
                    <l7:PolicyDetail folderId="bf814e308b5a7ca01522e3ee189aa7d3" guid="72847008-0b74-44d5-a0e9-86c25c2fdbca" id="fab70e93841614f8f7afa0ce880ae52d" version="0">
                        <l7:Name>Remove Org</l7:Name>
                        <l7:PolicyType>Include</l7:PolicyType>
                        <l7:Properties>
                            <l7:Property key="hasRouting">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                            <l7:Property key="revision">
                                <l7:LongValue>1</l7:LongValue>
                            </l7:Property>
                            <l7:Property key="soap">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                        </l7:Properties>
                    </l7:PolicyDetail>
                    <l7:Resources>
                        <l7:ResourceSet tag="policy">
                            <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
    &lt;wsp:All wsp:Usage="Required"&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment="included"&gt;
                &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="// This represents the ${apikeyRecord.label}"/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue="JHthcGlrZXlSZWNvcmQubGFiZWx9"/&gt;
            &lt;L7p:ContentType stringValue="text/xml; charset=utf-8"/&gt;
            &lt;L7p:DataType variableDataType="message"/&gt;
            &lt;L7p:VariableToSet stringValue="appName"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment="included"&gt;
                &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="// This represents the ${apiKeyRecord.accountPlanMappingName}"/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue="JHthcGlLZXlSZWNvcmQuYWNjb3VudFBsYW5NYXBwaW5nTmFtZX0="/&gt;
            &lt;L7p:VariableToSet stringValue="org"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment="included"&gt;
                &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="// Add the leading hyphen right before the organization"/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue="LSR7b3JnfQ=="/&gt;
            &lt;L7p:VariableToSet stringValue="leadingHyphen"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:Regex&gt;
            &lt;L7p:AssertionComment assertionComment="included"&gt;
                &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="// Remove the organization from the application name"/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:AutoTarget booleanValue="false"/&gt;
            &lt;L7p:OtherTargetMessageVariable stringValue="appName"/&gt;
            &lt;L7p:PatternContainsVariables booleanValue="true"/&gt;
            &lt;L7p:Regex stringValue="${leadingHyphen}"/&gt;
            &lt;L7p:Replace booleanValue="true"/&gt;
            &lt;L7p:Replacement stringValue=""/&gt;
            &lt;L7p:Target target="OTHER"/&gt;
        &lt;/L7p:Regex&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment="included"&gt;
                &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="// Add the leading hyphen right before the organization"/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue="LWFwaSBrZXkgMQ=="/&gt;
            &lt;L7p:VariableToSet stringValue="keyName"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:Regex&gt;
            &lt;L7p:AssertionComment assertionComment="included"&gt;
                &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="// Remove the organization from the application name"/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:AutoTarget booleanValue="false"/&gt;
            &lt;L7p:OtherTargetMessageVariable stringValue="appName"/&gt;
            &lt;L7p:PatternContainsVariables booleanValue="true"/&gt;
            &lt;L7p:Regex stringValue="${keyName}"/&gt;
            &lt;L7p:Replace booleanValue="true"/&gt;
            &lt;L7p:Replacement stringValue=""/&gt;
            &lt;L7p:Target target="OTHER"/&gt;
        &lt;/L7p:Regex&gt;
        &lt;L7p:TrueAssertion&gt;
            &lt;L7p:AssertionComment assertionComment="included"&gt;
                &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="// ${label.mainpart} would be the context variable you reference"/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
        &lt;/L7p:TrueAssertion&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                        </l7:ResourceSet>
                    </l7:Resources>
                </l7:Policy>
            </l7:Resource>
        </l7:Item>
        <l7:Item>
            <l7:Name>Portal Service Snippet Key Required - Not forward key</l7:Name>
            <l7:Id>7b102159b1681248185594073ef7c9d4</l7:Id>
            <l7:Type>POLICY</l7:Type>
            <l7:TimeStamp>2023-07-20T12:13:39.919-05:00</l7:TimeStamp>
            <l7:Resource>
                <l7:Policy guid="e29e5f47-d7f7-4e0c-872c-8925f729c385" id="7b102159b1681248185594073ef7c9d4" version="13">
                    <l7:PolicyDetail folderId="e0ad1669c153959e456e8c76f73bb227" guid="e29e5f47-d7f7-4e0c-872c-8925f729c385" id="7b102159b1681248185594073ef7c9d4" version="13">
                        <l7:Name>Portal Service Snippet Key Required - Not forward key</l7:Name>
                        <l7:PolicyType>Include</l7:PolicyType>
                        <l7:Properties>
                            <l7:Property key="hasRouting">
                                <l7:BooleanValue>true</l7:BooleanValue>
                            </l7:Property>
                            <l7:Property key="revision">
                                <l7:LongValue>14</l7:LongValue>
                            </l7:Property>
                            <l7:Property key="soap">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                        </l7:Properties>
                    </l7:PolicyDetail>
                    <l7:Resources>
                        <l7:ResourceSet tag="policy">
                            <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
    &lt;wsp:All wsp:Usage="Required"&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="============================"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="= API Portal Integration components below ="/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="============================"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue="ZmFsc2U="/&gt;
            &lt;L7p:VariableToSet stringValue="apikeyfound"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment="included"&gt;
                &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="getRequestedApiResource()"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="// capture the API resource requested"/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAudXJpfQ=="/&gt;
            &lt;L7p:VariableToSet stringValue="apiResource"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:Include&gt;
            &lt;L7p:PolicyGuid stringValue="812ed196-c315-4e92-b630-b5c64c5c043c"/&gt;
            &lt;L7p:PolicyName stringValue="Portal Service Preface"/&gt;
        &lt;/L7p:Include&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.header.apikey}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="string"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:Negated booleanValue="true"/&gt;
                            &lt;L7p:Operator operator="EMPTY"/&gt;
                            &lt;L7p:RightValue stringValue=""/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="dHJ1ZQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="apikeyfound"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                        &lt;L7p:Properties mapValue="included"&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="getRequestApiKey()"/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="// parse API key from request"/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAuaGVhZGVyLmFwaWtleX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="lookupApiKey"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Check in the header for API key"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.apikey}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="string"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:Negated booleanValue="true"/&gt;
                            &lt;L7p:Operator operator="EMPTY"/&gt;
                            &lt;L7p:RightValue stringValue=""/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="dHJ1ZQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="apikeyfound"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                        &lt;L7p:Properties mapValue="included"&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="getRequestApiKey()"/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="// parse API key from request"/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmFwaWtleX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="lookupApiKey"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Check in the query parameter for API key"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:TrueAssertion/&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="Check for API key either in header or query parameter"/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${apikeyfound}"/&gt;
                    &lt;L7p:Expression2 stringValue="false"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:RightValue stringValue="false"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:Include&gt;
                        &lt;L7p:PolicyGuid stringValue="d118492b-249b-483f-aa3a-93f2ec1685bd"/&gt;
                        &lt;L7p:PolicyName stringValue="Tibco IPs"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:HardcodedResponse&gt;
                            &lt;L7p:Base64ResponseBody stringValue="ewoiZXJyb3IiOiB7CiAiZXJyb3JzIjogWwogIHsKICAgInJlYXNvbiI6ICJyZXF1aXJlZCIsCiAgICJsb2NhdGlvblR5cGUiOiAiaGVhZGVyIiwKICAgImxvY2F0aW9uIjogImFwaWtleSIKICB9CiBdLAogImNvZGUiOiA0MDEsCiAibWVzc2FnZSI6ICJhcGlrZXkgcmVxdWlyZWQiCiB9Cn0="/&gt;
                            &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                            &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                            &lt;L7p:ResponseStatus stringValue="401"/&gt;
                        &lt;/L7p:HardcodedResponse&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="NDAx"/&gt;
                            &lt;L7p:DataType variableDataType="int"/&gt;
                            &lt;L7p:VariableToSet stringValue="status"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:AuditDetailAssertion&gt;
                            &lt;L7p:CustomLoggerSuffix stringValue="splunkLog"/&gt;
                            &lt;L7p:Detail stringValue="{ &amp;quot;@timestamp&amp;quot;:&amp;quot;${gateway.time.local}&amp;quot;, &amp;quot;@version&amp;quot;:&amp;quot;1&amp;quot;, &amp;quot;level&amp;quot;:&amp;quot;INFO&amp;quot;, &amp;quot;logsource&amp;quot;:&amp;quot;wsag&amp;quot;, &amp;quot;logsourcetype&amp;quot;:&amp;quot;wsag_security&amp;quot;, &amp;quot;logidx&amp;quot;:&amp;quot;${gateway.splunkIndex}&amp;quot;,&amp;quot;requestId&amp;quot;: &amp;quot;${requestId}&amp;quot;, &amp;quot;environment&amp;quot;:&amp;quot;${gateway.environment}&amp;quot;, &amp;quot;region&amp;quot;:&amp;quot;${gateway.networkRegion}&amp;quot;, &amp;quot;routinghost&amp;quot;:&amp;quot;${httprouting.url.host}&amp;quot;, &amp;quot;message&amp;quot;:&amp;quot;apikey was not sent&amp;quot; }"/&gt;
                            &lt;L7p:Level stringValue="WARNING"/&gt;
                            &lt;L7p:LoggingOnly booleanValue="true"/&gt;
                        &lt;/L7p:AuditDetailAssertion&gt;
                        &lt;L7p:AuditDetailAssertion&gt;
                            &lt;L7p:Detail stringValue="apikey was not sent"/&gt;
                            &lt;L7p:Level stringValue="WARNING"/&gt;
                        &lt;/L7p:AuditDetailAssertion&gt;
                        &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All L7p:Enabled="false" wsp:Usage="Required"&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${apikeyfound}"/&gt;
                    &lt;L7p:Expression2 stringValue="false"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item binary="included"&gt;
                            &lt;L7p:RightValue stringValue="false"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="ZmFsc2U="/&gt;
                    &lt;L7p:VariableToSet stringValue="apiKeyRecord.found"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue="An API Key was not found for this request."/&gt;
                    &lt;L7p:Level stringValue="WARNING"/&gt;
                &lt;/L7p:AuditDetailAssertion&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="Enable to make the apikey optional"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:Encapsulated&gt;
                        &lt;L7p:EncapsulatedAssertionConfigGuid stringValue="d6b48093-4288-44b3-977e-712fdac328e6"/&gt;
                        &lt;L7p:EncapsulatedAssertionConfigName stringValue="Portal Look Up API Key"/&gt;
                        &lt;L7p:Parameters mapValue="included"&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="apikey"/&gt;
                                &lt;L7p:value stringValue="${lookupApiKey}"/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="custom"/&gt;
                                &lt;L7p:value stringValue=""/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="serviceid"/&gt;
                                &lt;L7p:value stringValue="${portal.managed.service.apiId}"/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Parameters&gt;
                    &lt;/L7p:Encapsulated&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                        &lt;wsp:All wsp:Usage="Required"&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                &lt;L7p:Expression1 stringValue="${apiKeyRecord.found}"/&gt;
                                &lt;L7p:Operator operatorNull="null"/&gt;
                                &lt;L7p:Predicates predicates="included"&gt;
                                    &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="string"/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:RightValue stringValue="true"/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                &lt;L7p:Expression1 stringValue="${apiKeyRecord.service}"/&gt;
                                &lt;L7p:Operator operatorNull="null"/&gt;
                                &lt;L7p:Predicates predicates="included"&gt;
                                    &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="string"/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:RightValue stringValue="${portal.managed.service.apiId}"/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                &lt;L7p:Expression1 stringValue="${apiKeyRecord.status}"/&gt;
                                &lt;L7p:Operator operatorNull="null"/&gt;
                                &lt;L7p:Predicates predicates="included"&gt;
                                    &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="string"/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:RightValue stringValue="active"/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue="included"&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                    &lt;L7p:value stringValue="// success - API key found"/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:All&gt;
                        &lt;wsp:All wsp:Usage="Required"&gt;
                            &lt;L7p:HardcodedResponse&gt;
                                &lt;L7p:Base64ResponseBody stringValue="ewogICJlcnJvcnMiOiBbCiAgICB7CiAgICAgICJtZXNzYWdlIjogIkludmFsaWQgYXBpa2V5IiwKICAgICAgImNvZGUiOiA0MDEKICAgIH0KICBdCn0="/&gt;
                                &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                                &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                                &lt;L7p:ResponseStatus stringValue="401"/&gt;
                            &lt;/L7p:HardcodedResponse&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue="NDAx"/&gt;
                                &lt;L7p:DataType variableDataType="int"/&gt;
                                &lt;L7p:VariableToSet stringValue="status"/&gt;
                            &lt;/L7p:SetVariable&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue="JHtsb29rdXBBcGlLZXl9"/&gt;
                                &lt;L7p:VariableToSet stringValue="apikeyMasked"/&gt;
                            &lt;/L7p:SetVariable&gt;
                            &lt;L7p:Regex&gt;
                                &lt;L7p:AutoTarget booleanValue="false"/&gt;
                                &lt;L7p:IncludeEntireExpressionCapture booleanValue="false"/&gt;
                                &lt;L7p:OtherTargetMessageVariable stringValue="apikeyMasked"/&gt;
                                &lt;L7p:Regex stringValue="l7.+?(?=.{4}( |&amp;quot;|&amp;amp;|\z))"/&gt;
                                &lt;L7p:RegexName stringValue="Mask standalone apikey"/&gt;
                                &lt;L7p:Replace booleanValue="true"/&gt;
                                &lt;L7p:Replacement stringValue="l7#######"/&gt;
                                &lt;L7p:Target target="OTHER"/&gt;
                            &lt;/L7p:Regex&gt;
                            &lt;L7p:AuditDetailAssertion&gt;
                                &lt;L7p:CustomLoggerSuffix stringValue="splunkLog"/&gt;
                                &lt;L7p:Detail stringValue="{ &amp;quot;@timestamp&amp;quot;:&amp;quot;${gateway.time.local}&amp;quot;, &amp;quot;@version&amp;quot;:&amp;quot;1&amp;quot;, &amp;quot;level&amp;quot;:&amp;quot;INFO&amp;quot;, &amp;quot;logsource&amp;quot;:&amp;quot;wsag&amp;quot;, &amp;quot;logsourcetype&amp;quot;:&amp;quot;wsag_security&amp;quot;, &amp;quot;logidx&amp;quot;:&amp;quot;${gateway.splunkIndex}&amp;quot;,&amp;quot;requestId&amp;quot;: &amp;quot;${requestId}&amp;quot;, &amp;quot;environment&amp;quot;:&amp;quot;${gateway.environment}&amp;quot;, &amp;quot;region&amp;quot;:&amp;quot;${gateway.networkRegion}&amp;quot;, &amp;quot;routinghost&amp;quot;:&amp;quot;${httprouting.url.host}&amp;quot;, &amp;quot;message&amp;quot;:&amp;quot;An invalid apikey of: ${apikeyMasked} was sent&amp;quot;, &amp;quot;detail&amp;quot;:&amp;quot;${apiAuthzDetails}&amp;quot; }"/&gt;
                                &lt;L7p:Level stringValue="WARNING"/&gt;
                                &lt;L7p:LoggingOnly booleanValue="true"/&gt;
                            &lt;/L7p:AuditDetailAssertion&gt;
                            &lt;L7p:AuditDetailAssertion&gt;
                                &lt;L7p:Detail stringValue="An invalid apikey of: ${apikeyMasked} was sent"/&gt;
                                &lt;L7p:Level stringValue="WARNING"/&gt;
                            &lt;/L7p:AuditDetailAssertion&gt;
                            &lt;L7p:FalseAssertion/&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue="included"&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                    &lt;L7p:value stringValue="// error - API key not found"/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:All&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue="included"&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="Step 1 --"/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="Lookup API Key"/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue="JHthcGlLZXlSZWNvcmQua2V5fQ=="/&gt;
                        &lt;L7p:VariableToSet stringValue="apiKey"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue="JHthcGlLZXlSZWNvcmQucGxhbn0="/&gt;
                        &lt;L7p:VariableToSet stringValue="apiPlan"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue="JHthcGlLZXlSZWNvcmQuYWNjb3VudFBsYW5NYXBwaW5nSWR9"/&gt;
                        &lt;L7p:VariableToSet stringValue="accountPlanMappingId"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:MessageContextAssertion&gt;
                        &lt;L7p:AssertionComment assertionComment="included"&gt;
                            &lt;L7p:Properties mapValue="included"&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                    &lt;L7p:value stringValue="// capture API key and requested method (used by analytics)"/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:AssertionComment&gt;
                        &lt;L7p:Mappings mappingInfoArray="included"&gt;
                            &lt;L7p:item mappingInfo="included"&gt;
                                &lt;L7p:Key stringValue="AUTH_USER"/&gt;
                                &lt;L7p:MappingType mappingType="AUTH_USER"/&gt;
                                &lt;L7p:Value stringValue="(SYSTEM DEFINED)"/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item mappingInfo="included"&gt;
                                &lt;L7p:Key stringValue="API_KEY"/&gt;
                                &lt;L7p:MappingType mappingType="CUSTOM_MAPPING"/&gt;
                                &lt;L7p:Value stringValue="${apikey}"/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item mappingInfo="included"&gt;
                                &lt;L7p:Key stringValue="API_METHOD"/&gt;
                                &lt;L7p:MappingType mappingType="CUSTOM_MAPPING"/&gt;
                                &lt;L7p:Value stringValue=""/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Mappings&gt;
                    &lt;/L7p:MessageContextAssertion&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue="included"&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="Step 2 --"/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="// Capture API key and API method for metrics"/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                        &lt;L7p:Comment stringValue="The Account Plans Fragment must be manually added here"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:Include&gt;
                        &lt;L7p:PolicyGuid stringValue="f8a5669d-831e-4417-9225-f52527f90323"/&gt;
                        &lt;L7p:PolicyName stringValue="Account Plans Fragment"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Expression1 stringValue="${apiAuthz}"/&gt;
                            &lt;L7p:Operator operatorNull="null"/&gt;
                            &lt;L7p:Predicates predicates="included"&gt;
                                &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="string"/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:RightValue stringValue="true"/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;wsp:All wsp:Usage="Required"&gt;
                            &lt;L7p:HardcodedResponse&gt;
                                &lt;L7p:Base64ResponseBody stringValue="ewogICJlcnJvcnMiOiBbCiAgICB7CiAgICAgICJtZXNzYWdlIjogIkFjY291bnQgcGxhbiByYXRlIGxpbWl0IGV4Y2VlZGVkIiwKICAgICAgImNvZGUiOiA0MDI4CiAgICB9CiAgXQp9"/&gt;
                                &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                                &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                                &lt;L7p:ResponseStatus stringValue="429"/&gt;
                            &lt;/L7p:HardcodedResponse&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue="NDI5"/&gt;
                                &lt;L7p:DataType variableDataType="int"/&gt;
                                &lt;L7p:VariableToSet stringValue="status"/&gt;
                            &lt;/L7p:SetVariable&gt;
                            &lt;L7p:Regex&gt;
                                &lt;L7p:AutoTarget booleanValue="false"/&gt;
                                &lt;L7p:IncludeEntireExpressionCapture booleanValue="false"/&gt;
                                &lt;L7p:OtherTargetMessageVariable stringValue="apiAuthzDetails"/&gt;
                                &lt;L7p:Regex stringValue="l7.+?(?=.{4}( |&amp;quot;|&amp;amp;|\z))"/&gt;
                                &lt;L7p:RegexName stringValue="Mask standalone apikey"/&gt;
                                &lt;L7p:Replace booleanValue="true"/&gt;
                                &lt;L7p:Replacement stringValue="l7#######"/&gt;
                                &lt;L7p:Target target="OTHER"/&gt;
                            &lt;/L7p:Regex&gt;
                            &lt;L7p:AuditDetailAssertion&gt;
                                &lt;L7p:CustomLoggerSuffix stringValue="splunkLog"/&gt;
                                &lt;L7p:Detail stringValue="{ &amp;quot;@timestamp&amp;quot;:&amp;quot;${gateway.time.local}&amp;quot;, &amp;quot;@version&amp;quot;:&amp;quot;1&amp;quot;, &amp;quot;level&amp;quot;:&amp;quot;INFO&amp;quot;, &amp;quot;logsource&amp;quot;:&amp;quot;wsag&amp;quot;, &amp;quot;logsourcetype&amp;quot;:&amp;quot;wsag_security&amp;quot;, &amp;quot;logidx&amp;quot;:&amp;quot;${gateway.splunkIndex}&amp;quot;, &amp;quot;environment&amp;quot;:&amp;quot;${gateway.environment}&amp;quot;, &amp;quot;region&amp;quot;:&amp;quot;${gateway.networkRegion}&amp;quot;, &amp;quot;requestId&amp;quot;:&amp;quot;${requestId}&amp;quot;, &amp;quot;message&amp;quot;:&amp;quot;Account Plan rate limit exceeded&amp;quot;, &amp;quot;service&amp;quot;:&amp;quot;${service.name}&amp;quot;, &amp;quot;responseStatus&amp;quot;:&amp;quot;429&amp;quot;, &amp;quot;detail&amp;quot;:&amp;quot;${apiAuthzDetails}&amp;quot; }"/&gt;
                                &lt;L7p:Level stringValue="WARNING"/&gt;
                                &lt;L7p:LoggingOnly booleanValue="true"/&gt;
                            &lt;/L7p:AuditDetailAssertion&gt;
                            &lt;L7p:FalseAssertion/&gt;
                        &lt;/wsp:All&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue="included"&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="Step 3 --"/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="// Enforce Account Plan restriction"/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                        &lt;L7p:Comment stringValue="The API Plans Fragment must be manually added here"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:Include&gt;
                        &lt;L7p:PolicyGuid stringValue="f8a5669d-831e-4417-9225-f52527f90212"/&gt;
                        &lt;L7p:PolicyName stringValue="API Plans Traffic Enforcement Fragment"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Expression1 stringValue="${apiAuthz}"/&gt;
                            &lt;L7p:Operator operatorNull="null"/&gt;
                            &lt;L7p:Predicates predicates="included"&gt;
                                &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="string"/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:RightValue stringValue="true"/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;wsp:All wsp:Usage="Required"&gt;
                            &lt;L7p:HardcodedResponse&gt;
                                &lt;L7p:Base64ResponseBody stringValue="ewogICJlcnJvcnMiOiBbCiAgICB7CiAgICAgICJtZXNzYWdlIjogIkFQSSBwbGFuIHJhdGUgbGltaXQgZXhjZWVkZWQiLAogICAgICAiY29kZSI6IDQwMjgKICAgIH0KICBdCn0="/&gt;
                                &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                                &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                                &lt;L7p:ResponseStatus stringValue="429"/&gt;
                            &lt;/L7p:HardcodedResponse&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue="NDI5"/&gt;
                                &lt;L7p:DataType variableDataType="int"/&gt;
                                &lt;L7p:VariableToSet stringValue="status"/&gt;
                            &lt;/L7p:SetVariable&gt;
                            &lt;L7p:Regex&gt;
                                &lt;L7p:AutoTarget booleanValue="false"/&gt;
                                &lt;L7p:IncludeEntireExpressionCapture booleanValue="false"/&gt;
                                &lt;L7p:OtherTargetMessageVariable stringValue="apiAuthzDetails"/&gt;
                                &lt;L7p:Regex stringValue="l7.+?(?=.{4}( |&amp;quot;|&amp;amp;|\z))"/&gt;
                                &lt;L7p:RegexName stringValue="Mask standalone apikey"/&gt;
                                &lt;L7p:Replace booleanValue="true"/&gt;
                                &lt;L7p:Replacement stringValue="l7#######"/&gt;
                                &lt;L7p:Target target="OTHER"/&gt;
                            &lt;/L7p:Regex&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue="JHthcGlLZXl9"/&gt;
                                &lt;L7p:VariableToSet stringValue="apikeyMasked"/&gt;
                            &lt;/L7p:SetVariable&gt;
                            &lt;L7p:Regex&gt;
                                &lt;L7p:AutoTarget booleanValue="false"/&gt;
                                &lt;L7p:IncludeEntireExpressionCapture booleanValue="false"/&gt;
                                &lt;L7p:OtherTargetMessageVariable stringValue="apikeyMasked"/&gt;
                                &lt;L7p:Regex stringValue="l7.+?(?=.{4}( |&amp;quot;|&amp;amp;|\z))"/&gt;
                                &lt;L7p:RegexName stringValue="Mask standalone apikey"/&gt;
                                &lt;L7p:Replace booleanValue="true"/&gt;
                                &lt;L7p:Replacement stringValue="l7#######"/&gt;
                                &lt;L7p:Target target="OTHER"/&gt;
                            &lt;/L7p:Regex&gt;
                            &lt;L7p:AuditDetailAssertion&gt;
                                &lt;L7p:Detail stringValueReference="inline"&gt;&lt;![CDATA[API plan limit exceeded

Reason: ${apiAuthzDetails}]]&gt;&lt;/L7p:Detail&gt;
                                &lt;L7p:Level stringValue="WARNING"/&gt;
                            &lt;/L7p:AuditDetailAssertion&gt;
                            &lt;L7p:AuditDetailAssertion&gt;
                                &lt;L7p:CustomLoggerSuffix stringValue="splunkLog"/&gt;
                                &lt;L7p:Detail stringValue="{ &amp;quot;@timestamp&amp;quot;:&amp;quot;${gateway.time.local}&amp;quot;, &amp;quot;@version&amp;quot;:&amp;quot;1&amp;quot;, &amp;quot;level&amp;quot;:&amp;quot;INFO&amp;quot;, &amp;quot;logsource&amp;quot;:&amp;quot;wsag&amp;quot;, &amp;quot;logsourcetype&amp;quot;:&amp;quot;wsag_security&amp;quot;, &amp;quot;logidx&amp;quot;:&amp;quot;${gateway.splunkIndex}&amp;quot;, &amp;quot;environment&amp;quot;:&amp;quot;${gateway.environment}&amp;quot;, &amp;quot;region&amp;quot;:&amp;quot;${gateway.networkRegion}&amp;quot;, &amp;quot;requestId&amp;quot;:&amp;quot;${requestId}&amp;quot;, &amp;quot;message&amp;quot;:&amp;quot;API plan rate limit exceeded&amp;quot;, &amp;quot;service&amp;quot;:&amp;quot;${service.name}&amp;quot;, &amp;quot;responseStatus&amp;quot;:&amp;quot;429&amp;quot;, &amp;quot;details&amp;quot;:&amp;quot;${apiAuthzDetails}&amp;quot;, &amp;quot;identifier&amp;quot;:&amp;quot;${service.oid}-${apikeyMasked}&amp;quot; }"/&gt;
                                &lt;L7p:Level stringValue="WARNING"/&gt;
                                &lt;L7p:LoggingOnly booleanValue="true"/&gt;
                            &lt;/L7p:AuditDetailAssertion&gt;
                            &lt;L7p:FalseAssertion/&gt;
                        &lt;/wsp:All&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue="included"&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="Step 4 --"/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="// Enforce API Plan restriction"/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                            &lt;L7p:value stringValue="// API Portal Integration section"/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="==========================="/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="= The rest of the service policy follows ... ="/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="==========================="/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="audit.apiKeyRecord.label"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="application"/&gt;
                    &lt;L7p:TransformType transformType="URL_DECODE"/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHthcHBsaWNhdGlvbn0="/&gt;
                    &lt;L7p:VariableToSet stringValue="appName"/&gt;
                &lt;/L7p:SetVariable&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:TrueAssertion/&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:Regex&gt;
            &lt;L7p:AutoTarget booleanValue="false"/&gt;
            &lt;L7p:CaseInsensitive booleanValue="true"/&gt;
            &lt;L7p:Regex stringValue="(&amp;lt;)(\w+:)CLIENT_ID&gt;(.+?)?&amp;lt;\/(\w+:)CLIENT_ID&gt;"/&gt;
            &lt;L7p:RegexName stringValue="Put apikey in SOAP Body"/&gt;
            &lt;L7p:Replace booleanValue="true"/&gt;
            &lt;L7p:Replacement stringValue="&amp;lt;$2CLIENT_ID&gt;${lookupApiKey}&amp;lt;/$4CLIENT_ID&gt;"/&gt;
        &lt;/L7p:Regex&gt;
        &lt;L7p:Include&gt;
            &lt;L7p:PolicyGuid stringValue="72847008-0b74-44d5-a0e9-86c25c2fdbca"/&gt;
            &lt;L7p:PolicyName stringValue="Remove Org"/&gt;
        &lt;/L7p:Include&gt;
        &lt;L7p:AddHeader&gt;
            &lt;L7p:HeaderName stringValue="apikey"/&gt;
            &lt;L7p:HeaderValue stringValue=""/&gt;
            &lt;L7p:Operation operation="REMOVE"/&gt;
            &lt;L7p:RemoveExisting booleanValue="true"/&gt;
        &lt;/L7p:AddHeader&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;L7p:EncodeDecode&gt;
                &lt;L7p:SourceVariableName stringValue="appName.mainpart"/&gt;
                &lt;L7p:TargetDataType variableDataType="string"/&gt;
                &lt;L7p:TargetVariableName stringValue="apiKeyRecord.label"/&gt;
                &lt;L7p:TransformType transformType="URL_DECODE"/&gt;
            &lt;/L7p:EncodeDecode&gt;
            &lt;L7p:TrueAssertion/&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:ExportVariables&gt;
            &lt;L7p:ExportedVars stringArrayValue="included"&gt;
                &lt;L7p:item stringValue="apiKeyRecord.accountPlanMappingId"/&gt;
                &lt;L7p:item stringValue="apiKeyRecord.found"/&gt;
                &lt;L7p:item stringValue="apiKeyRecord.key"/&gt;
                &lt;L7p:item stringValue="apiKeyRecord.label"/&gt;
                &lt;L7p:item stringValue="apiKeyRecord.oauthCallbackUrl"/&gt;
                &lt;L7p:item stringValue="apiKeyRecord.oauthScope"/&gt;
                &lt;L7p:item stringValue="apiKeyRecord.oauthType"/&gt;
                &lt;L7p:item stringValue="apiKeyRecord.plan"/&gt;
                &lt;L7p:item stringValue="apiKeyRecord.platform"/&gt;
                &lt;L7p:item stringValue="apiKeyRecord.secret"/&gt;
                &lt;L7p:item stringValue="apiKeyRecord.service"/&gt;
                &lt;L7p:item stringValue="apiKeyRecord.status"/&gt;
                &lt;L7p:item stringValue="apiKeyRecord.version"/&gt;
                &lt;L7p:item stringValue="apiKeyRecord.xml"/&gt;
            &lt;/L7p:ExportedVars&gt;
        &lt;/L7p:ExportVariables&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                        </l7:ResourceSet>
                    </l7:Resources>
                </l7:Policy>
            </l7:Resource>
        </l7:Item>
        <l7:Item>
            <l7:Name>Security Best Practices REST Service</l7:Name>
            <l7:Id>cc2f26a419d076b03f43739abfbbaebd</l7:Id>
            <l7:Type>POLICY</l7:Type>
            <l7:TimeStamp>2023-07-20T12:13:39.933-05:00</l7:TimeStamp>
            <l7:Resource>
                <l7:Policy guid="b66f73cb-560c-4a43-9b71-debf1665a6f5" id="cc2f26a419d076b03f43739abfbbaebd" version="4">
                    <l7:PolicyDetail folderId="bf814e308b5a7ca01522e3ee189aa7d3" guid="b66f73cb-560c-4a43-9b71-debf1665a6f5" id="cc2f26a419d076b03f43739abfbbaebd" version="4">
                        <l7:Name>Security Best Practices REST Service</l7:Name>
                        <l7:PolicyType>Include</l7:PolicyType>
                        <l7:Properties>
                            <l7:Property key="hasRouting">
                                <l7:BooleanValue>true</l7:BooleanValue>
                            </l7:Property>
                            <l7:Property key="revision">
                                <l7:LongValue>6</l7:LongValue>
                            </l7:Property>
                            <l7:Property key="soap">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                        </l7:Properties>
                    </l7:PolicyDetail>
                    <l7:Resources>
                        <l7:ResourceSet tag="policy">
                            <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
    &lt;wsp:All wsp:Usage="Required"&gt;
        &lt;L7p:AuditDetailAssertion&gt;
            &lt;L7p:Detail stringValue="Policy Fragment: Security Best Practices REST Service"/&gt;
        &lt;/L7p:AuditDetailAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="This Policy Fragents accepts below context variables(Optional)"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="     1. MessageSize , MessageSizeKbLimit"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="     2.SQLAttacks"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="     3.CodeInjection"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="     4.DocStructure"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                        &lt;L7p:Expression1 stringValue="${MessageSize}"/&gt;
                        &lt;L7p:Operator operatorNull="null"/&gt;
                        &lt;L7p:Predicates predicates="included"&gt;
                            &lt;L7p:item dataType="included"&gt;
                                &lt;L7p:Type variableDataType="string"/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary="included"&gt;
                                &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                &lt;L7p:RightValue stringValue="Disable"/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="TWVzc2FnZSBTaXplIExpbWl0IEV4Y2VlZGVk"/&gt;
                            &lt;L7p:VariableToSet stringValue="errorMessage"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                &lt;L7p:Expression1 stringValue="${MessageSizeKbLimit}"/&gt;
                                &lt;L7p:Operator operatorNull="null"/&gt;
                                &lt;L7p:Predicates predicates="included"&gt;
                                    &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="int"/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                    &lt;L7p:Negated booleanValue="true"/&gt;
                                    &lt;L7p:Operator operator="EMPTY"/&gt;
                                    &lt;L7p:RightValue stringValue="Disable"/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue="JHtnYXRld2F5LnJlcXVlc3QuTWF4TWVzc2FnZVNpemV9"/&gt;
                                &lt;L7p:DataType variableDataType="int"/&gt;
                                &lt;L7p:VariableToSet stringValue="MessageSizeKbLimit"/&gt;
                            &lt;/L7p:SetVariable&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:RequestSizeLimit&gt;
                            &lt;L7p:Limit stringValue="${MessageSizeKbLimit}"/&gt;
                        &lt;/L7p:RequestSizeLimit&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue="included"&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="To Check Limit Message Size"/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                        &lt;L7p:Expression1 stringValue="${SQLAttacks}"/&gt;
                        &lt;L7p:Operator operatorNull="null"/&gt;
                        &lt;L7p:Predicates predicates="included"&gt;
                            &lt;L7p:item dataType="included"&gt;
                                &lt;L7p:Type variableDataType="string"/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary="included"&gt;
                                &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                &lt;L7p:RightValue stringValue="Disable"/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="U1FMIEF0dGFjayBEZXRlY3RlZA=="/&gt;
                            &lt;L7p:VariableToSet stringValue="errorMessage"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SqlAttackProtection&gt;
                            &lt;L7p:IncludeUrlQueryString booleanValue="true"/&gt;
                            &lt;L7p:Protections stringSetValue="included"&gt;
                                &lt;L7p:item stringValue="SqlMetaText"/&gt;
                                &lt;L7p:item stringValue="MsSql"/&gt;
                            &lt;/L7p:Protections&gt;
                        &lt;/L7p:SqlAttackProtection&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue="included"&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="Protection Against SQL Attacks"/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                        &lt;L7p:Expression1 stringValue="${CodeInjection}"/&gt;
                        &lt;L7p:Operator operatorNull="null"/&gt;
                        &lt;L7p:Predicates predicates="included"&gt;
                            &lt;L7p:item dataType="included"&gt;
                                &lt;L7p:Type variableDataType="string"/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary="included"&gt;
                                &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                &lt;L7p:RightValue stringValue="Disable"/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="Q29kZSBJbmplY3Rpb24gRGV0ZWN0ZWQ="/&gt;
                            &lt;L7p:VariableToSet stringValue="errorMessage"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:CodeInjectionProtectionAssertion&gt;
                            &lt;L7p:IncludeBody booleanValue="true"/&gt;
                            &lt;L7p:IncludeUrlQueryString booleanValue="true"/&gt;
                            &lt;L7p:Protections codeInjectionProtectionTypeArray="included"&gt;
                                &lt;L7p:item protectionType="htmlJavaScriptInjection"/&gt;
                                &lt;L7p:item protectionType="shellInjection"/&gt;
                                &lt;L7p:item protectionType="xpathInjection"/&gt;
                            &lt;/L7p:Protections&gt;
                            &lt;L7p:Target target="REQUEST"/&gt;
                        &lt;/L7p:CodeInjectionProtectionAssertion&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue="included"&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="Protection Against Code Injection"/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Expression1 stringValue="${DocStructure}"/&gt;
                            &lt;L7p:Operator operatorNull="null"/&gt;
                            &lt;L7p:Predicates predicates="included"&gt;
                                &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="string"/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                    &lt;L7p:RightValue stringValue="Disable"/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Expression1 stringValue="${request.http.method}"/&gt;
                            &lt;L7p:Operator operatorNull="null"/&gt;
                            &lt;L7p:Predicates predicates="included"&gt;
                                &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="string"/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                    &lt;L7p:RightValue stringValue="get"/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Expression1 stringValue="${request.http.method}"/&gt;
                            &lt;L7p:Operator operatorNull="null"/&gt;
                            &lt;L7p:Predicates predicates="included"&gt;
                                &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="string"/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                    &lt;L7p:RightValue stringValue="delete"/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="RG9jdW1lbnQgU3RydWN1dHVyZSBUaHJlYXQgRGV0ZWN0ZWQ="/&gt;
                            &lt;L7p:VariableToSet stringValue="errorMessage"/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                            &lt;L7p:JsonDocumentStructure&gt;
                                &lt;L7p:CheckContainerDepth booleanValue="false"/&gt;
                            &lt;/L7p:JsonDocumentStructure&gt;
                            &lt;L7p:OversizedText&gt;
                                &lt;L7p:LimitAttrChars booleanValue="false"/&gt;
                                &lt;L7p:LimitAttrNameChars booleanValue="false"/&gt;
                                &lt;L7p:LimitNestingDepth booleanValue="false"/&gt;
                                &lt;L7p:LimitTextChars booleanValue="false"/&gt;
                            &lt;/L7p:OversizedText&gt;
                        &lt;/wsp:OneOrMore&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue="included"&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="To Check Document Strucutre Threat"/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Error Handling"/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Expression1 stringValue="${request.http.header.content-type}"/&gt;
                            &lt;L7p:Operator operatorNull="null"/&gt;
                            &lt;L7p:Predicates predicates="included"&gt;
                                &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="string"/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                    &lt;L7p:RightValue stringValue="application/json"/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Expression1 stringValue="${request.http.header.content-type}"/&gt;
                            &lt;L7p:Operator operatorNull="null"/&gt;
                            &lt;L7p:Predicates predicates="included"&gt;
                                &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="string"/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                    &lt;L7p:RightValue stringValue="application/json; charset=UTF-8"/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                        &lt;L7p:Detail stringValue="${errorMessage}"/&gt;
                        &lt;L7p:Level stringValue="WARNING"/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                        &lt;L7p:CustomLoggerSuffix stringValue="splunkLog"/&gt;
                        &lt;L7p:Detail stringValue="{ &amp;quot;@timestamp&amp;quot;:&amp;quot;${gateway.time.local}&amp;quot;, &amp;quot;@version&amp;quot;:&amp;quot;1&amp;quot;, &amp;quot;level&amp;quot;:&amp;quot;INFO&amp;quot;, &amp;quot;logsource&amp;quot;:&amp;quot;wsag&amp;quot;, &amp;quot;logsourcetype&amp;quot;:&amp;quot;wsag_security&amp;quot;, &amp;quot;logidx&amp;quot;:&amp;quot;${gateway.splunkIndex}&amp;quot;, &amp;quot;environment&amp;quot;:&amp;quot;${gateway.environment}&amp;quot;, &amp;quot;region&amp;quot;:&amp;quot;${gateway.networkRegion}&amp;quot;, &amp;quot;requestId&amp;quot;:&amp;quot;${requestId}&amp;quot;, &amp;quot;message&amp;quot;:&amp;quot;${errorMessage}&amp;quot; }"/&gt;
                        &lt;L7p:Level stringValue="WARNING"/&gt;
                        &lt;L7p:LoggingOnly booleanValue="true"/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;L7p:HardcodedResponse&gt;
                        &lt;L7p:Base64ResponseBody stringValue="ewogImRvbWFpbiI6ICIke2dhdGV3YXkuY2x1c3Rlci5hcHBsaWNhdGlvbn0iLAogInJlYXNvbiI6ICJpbnZhbGlkUGF5bG9hZCIsCiAibWVzc2FnZSI6ICJVbmFibGUgdG8gcHJvY2VzcyB0aGUgcmVxdWVzdCBiZWNhdXNlICR7ZXJyb3JNZXNzYWdlfSIsCiAiY29kZSI6IDQwMwp9"/&gt;
                        &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                        &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                        &lt;L7p:ResponseStatus stringValue="403"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue="included"&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="JSON Error Response"/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Expression1 stringValue="${request.http.header.content-type}"/&gt;
                            &lt;L7p:Operator operatorNull="null"/&gt;
                            &lt;L7p:Predicates predicates="included"&gt;
                                &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="string"/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                    &lt;L7p:RightValue stringValue="application/xml"/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Expression1 stringValue="${request.http.header.content-type}"/&gt;
                            &lt;L7p:Operator operatorNull="null"/&gt;
                            &lt;L7p:Predicates predicates="included"&gt;
                                &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="string"/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                    &lt;L7p:RightValue stringValue="text/xml"/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Expression1 stringValue="${request.http.header.content-type}"/&gt;
                            &lt;L7p:Operator operatorNull="null"/&gt;
                            &lt;L7p:Predicates predicates="included"&gt;
                                &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="string"/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                    &lt;L7p:RightValue stringValue="application/xml; charset=UTF-8"/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Expression1 stringValue="${request.http.header.content-type}"/&gt;
                            &lt;L7p:Operator operatorNull="null"/&gt;
                            &lt;L7p:Predicates predicates="included"&gt;
                                &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="string"/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                    &lt;L7p:RightValue stringValue="text/xml; charset=UTF-8"/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                        &lt;L7p:Detail stringValue="${errorMessage}"/&gt;
                        &lt;L7p:Level stringValue="WARNING"/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                        &lt;L7p:CustomLoggerSuffix stringValue="splunkLog"/&gt;
                        &lt;L7p:Detail stringValue="{ &amp;quot;@timestamp&amp;quot;:&amp;quot;${gateway.time.local}&amp;quot;, &amp;quot;@version&amp;quot;:&amp;quot;1&amp;quot;, &amp;quot;level&amp;quot;:&amp;quot;INFO&amp;quot;, &amp;quot;logsource&amp;quot;:&amp;quot;wsag&amp;quot;, &amp;quot;logsourcetype&amp;quot;:&amp;quot;wsag_security&amp;quot;, &amp;quot;logidx&amp;quot;:&amp;quot;${gateway.splunkIndex}&amp;quot;, &amp;quot;environment&amp;quot;:&amp;quot;${gateway.environment}&amp;quot;, &amp;quot;region&amp;quot;:&amp;quot;${gateway.networkRegion}&amp;quot;, &amp;quot;requestId&amp;quot;:&amp;quot;${requestId}&amp;quot;, &amp;quot;message&amp;quot;:&amp;quot;${errorMessage}&amp;quot; }"/&gt;
                        &lt;L7p:Level stringValue="WARNING"/&gt;
                        &lt;L7p:LoggingOnly booleanValue="true"/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;L7p:HardcodedResponse&gt;
                        &lt;L7p:Base64ResponseBody stringValue="PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHJvb3Q+CiAgIDxjb2RlPjQwMzwvY29kZT4KICAgPGRvbWFpbj4ke2dhdGV3YXkuY2x1c3Rlci5hcHBsaWNhdGlvbn08L2RvbWFpbj4KICAgPG1lc3NhZ2U+VW5hYmxlIHRvIHByb2Nlc3MgdGhlIHJlcXVlc3QgYmVjYXVzZSAke2Vycm9yTWVzc2FnZX08L21lc3NhZ2U+CiAgIDxyZWFzb24+aW52YWxpZFBheWxvYWQ8L3JlYXNvbj4KPC9yb290Pg=="/&gt;
                        &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                        &lt;L7p:ResponseContentType stringValue="application/xml; charset=UTF-8"/&gt;
                        &lt;L7p:ResponseStatus stringValue="403"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue="included"&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="XML Error response"/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                        &lt;L7p:Comment stringValue="Default Error Message fragment to handle un recognized Content type."/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                        &lt;L7p:Detail stringValue="${errorMessage}"/&gt;
                        &lt;L7p:Level stringValue="WARNING"/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                        &lt;L7p:CustomLoggerSuffix stringValue="splunkLog"/&gt;
                        &lt;L7p:Detail stringValue="{ &amp;quot;@timestamp&amp;quot;:&amp;quot;${gateway.time.local}&amp;quot;, &amp;quot;@version&amp;quot;:&amp;quot;1&amp;quot;, &amp;quot;level&amp;quot;:&amp;quot;INFO&amp;quot;, &amp;quot;logsource&amp;quot;:&amp;quot;wsag&amp;quot;, &amp;quot;logsourcetype&amp;quot;:&amp;quot;wsag_security&amp;quot;, &amp;quot;logidx&amp;quot;:&amp;quot;${gateway.splunkIndex}&amp;quot;, &amp;quot;environment&amp;quot;:&amp;quot;${gateway.environment}&amp;quot;, &amp;quot;region&amp;quot;:&amp;quot;${gateway.networkRegion}&amp;quot;, &amp;quot;requestId&amp;quot;:&amp;quot;${requestId}&amp;quot;, &amp;quot;message&amp;quot;:&amp;quot;${errorMessage}&amp;quot; }"/&gt;
                        &lt;L7p:Level stringValue="WARNING"/&gt;
                        &lt;L7p:LoggingOnly booleanValue="true"/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;L7p:HardcodedResponse&gt;
                        &lt;L7p:Base64ResponseBody stringValue="Y29kZSA0MDMKZG9tYWluICR7Z2F0ZXdheS5jbHVzdGVyLmFwcGxpY2F0aW9ufQptZXNzYWdlIFVuYWJsZSB0byBwcm9jZXNzIHRoZSByZXF1ZXN0IGJlY2F1c2UgJHtlcnJvck1lc3NhZ2V9CnJlYXNvbiBpbnZhbGlkUGF5bG9hZA=="/&gt;
                        &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                        &lt;L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/&gt;
                        &lt;L7p:ResponseStatus stringValue="403"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:FalseAssertion/&gt;
                &lt;/wsp:All&gt;
            &lt;/wsp:OneOrMore&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:AuditDetailAssertion&gt;
            &lt;L7p:Detail stringValue="Policy Fragment: Completed processing Security Best Practices REST Service"/&gt;
        &lt;/L7p:AuditDetailAssertion&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                        </l7:ResourceSet>
                    </l7:Resources>
                </l7:Policy>
            </l7:Resource>
        </l7:Item>
        <l7:Item>
            <l7:Name>Send Routing Alerts</l7:Name>
            <l7:Id>08b77e9a36d9a0f4c92da9e60570b3a9</l7:Id>
            <l7:Type>POLICY</l7:Type>
            <l7:TimeStamp>2023-07-20T12:13:39.945-05:00</l7:TimeStamp>
            <l7:Resource>
                <l7:Policy guid="9808b740-1950-442d-ab78-a84a407a18da" id="08b77e9a36d9a0f4c92da9e60570b3a9" version="1">
                    <l7:PolicyDetail folderId="bf814e308b5a7ca01522e3ee189aa7d3" guid="9808b740-1950-442d-ab78-a84a407a18da" id="08b77e9a36d9a0f4c92da9e60570b3a9" version="1">
                        <l7:Name>Send Routing Alerts</l7:Name>
                        <l7:PolicyType>Include</l7:PolicyType>
                        <l7:Properties>
                            <l7:Property key="hasRouting">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                            <l7:Property key="revision">
                                <l7:LongValue>2</l7:LongValue>
                            </l7:Property>
                            <l7:Property key="soap">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                        </l7:Properties>
                    </l7:PolicyDetail>
                    <l7:Resources>
                        <l7:ResourceSet tag="policy">
                            <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
    &lt;wsp:All wsp:Usage="Required"&gt;
        &lt;L7p:AuditDetailAssertion&gt;
            &lt;L7p:Detail stringValue="Policy Fragment: Send SNMP traps"/&gt;
        &lt;/L7p:AuditDetailAssertion&gt;
        &lt;L7p:AuditDetailAssertion&gt;
            &lt;L7p:Detail stringValue="Status: ${httpRouting.reasonCode}"/&gt;
        &lt;/L7p:AuditDetailAssertion&gt;
        &lt;L7p:AuditDetailAssertion&gt;
            &lt;L7p:Detail stringValue="Latency: ${httpRouting.latency}"/&gt;
        &lt;/L7p:AuditDetailAssertion&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                &lt;L7p:Expression1 stringValue="${latencySLA}"/&gt;
                &lt;L7p:Operator operatorNull="null"/&gt;
                &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item dataType="included"&gt;
                        &lt;L7p:Type variableDataType="int"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item binary="included"&gt;
                        &lt;L7p:Operator operator="GT"/&gt;
                        &lt;L7p:RightValue stringValue="0"/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue="MzAwMDA="/&gt;
                &lt;L7p:DataType variableDataType="int"/&gt;
                &lt;L7p:VariableToSet stringValue="latencySLA"/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="Add default latency SLA"/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                &lt;L7p:Expression1 stringValue="${httpRouting.reasonCode}"/&gt;
                &lt;L7p:Operator operatorNull="null"/&gt;
                &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item dataType="included"&gt;
                        &lt;L7p:Type variableDataType="int"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item binary="included"&gt;
                        &lt;L7p:Operator operator="GE"/&gt;
                        &lt;L7p:RightValue stringValue="0"/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Expression1 stringValue="${httpRouting.reasonCode}"/&gt;
                            &lt;L7p:Operator operatorNull="null"/&gt;
                            &lt;L7p:Predicates predicates="included"&gt;
                                &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="int"/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:RightValue stringValue="-1"/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="VVJMIFVuYXZhaWxhYmxl"/&gt;
                            &lt;L7p:VariableToSet stringValue="reasonString"/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Expression1 stringValue="${httpRouting.reasonCode}"/&gt;
                            &lt;L7p:Operator operatorNull="null"/&gt;
                            &lt;L7p:Predicates predicates="included"&gt;
                                &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="int"/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:RightValue stringValue="-2"/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="QmFkIFVSTA=="/&gt;
                            &lt;L7p:VariableToSet stringValue="reasonString"/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Expression1 stringValue="${httpRouting.reasonCode}"/&gt;
                            &lt;L7p:Operator operatorNull="null"/&gt;
                            &lt;L7p:Predicates predicates="included"&gt;
                                &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="int"/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:RightValue stringValue="-3"/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="Q29ubmVjdGlvbiB0aW1lb3V0"/&gt;
                            &lt;L7p:VariableToSet stringValue="reasonString"/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Expression1 stringValue="${httpRouting.reasonCode}"/&gt;
                            &lt;L7p:Operator operatorNull="null"/&gt;
                            &lt;L7p:Predicates predicates="included"&gt;
                                &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="int"/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:RightValue stringValue="-4"/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="UmVhZCB0aW1lb3V0"/&gt;
                            &lt;L7p:VariableToSet stringValue="reasonString"/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                            &lt;L7p:Expression1 stringValue="${httpRouting.reasonCode}"/&gt;
                            &lt;L7p:Operator operatorNull="null"/&gt;
                            &lt;L7p:Predicates predicates="included"&gt;
                                &lt;L7p:item dataType="included"&gt;
                                    &lt;L7p:Type variableDataType="int"/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:RightValue stringValue="-5"/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue="VW5kZWZpbmVk"/&gt;
                            &lt;L7p:VariableToSet stringValue="reasonString"/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="Um91dGluZyBBc3NlcnRpb24gRmFpbGVkOiANClJlcXVlc3Qgc2VudCB0byAke2h0dHBSb3V0aW5nLnVybH0gZmFpbGVkIHdpdGggYSByZWFzb24gY29kZSBvZiAke2h0dHBSb3V0aW5nLnJlYXNvbkNvZGV9ICgke3JlYXNvblN0cmluZ30p"/&gt;
                    &lt;L7p:VariableToSet stringValue="snmpMessage"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:ConcurrentAll wsp:Usage="Required"&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                        &lt;L7p:Detail stringValue="ALERT -- The routing assertion failed"/&gt;
                        &lt;L7p:Level stringValue="WARNING"/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;L7p:SnmpTrap&gt;
                        &lt;L7p:Community stringValue="public"/&gt;
                        &lt;L7p:ErrorMessage stringValue="${snmpMessage}"/&gt;
                        &lt;L7p:Oid stringValue="2"/&gt;
                        &lt;L7p:TargetHostname stringValue="${gateway.snmpHost}"/&gt;
                    &lt;/L7p:SnmpTrap&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                        &lt;wsp:All wsp:Usage="Required"&gt;
                            &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                    &lt;L7p:Expression1 stringValue="${gateway.environment}"/&gt;
                                    &lt;L7p:Expression2 stringValue="prod"/&gt;
                                    &lt;L7p:Predicates predicates="included"&gt;
                                    &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                                    &lt;L7p:RightValue stringValue="prod"/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:Expression1 stringValue="${gateway.icc.sendEmailAlerts}"/&gt;
                                    &lt;L7p:Expression2 stringValue="Y"/&gt;
                                    &lt;L7p:Predicates predicates="included"&gt;
                                    &lt;L7p:item binary="included"&gt;
                                    &lt;L7p:RightValue stringValue="Y"/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                            &lt;/wsp:OneOrMore&gt;
                            &lt;L7p:Email&gt;
                                &lt;L7p:Base64message stringValue="JHtzbm1wTWVzc2FnZX0="/&gt;
                                &lt;L7p:SmtpHost stringValue="exchange.heb.com"/&gt;
                                &lt;L7p:SourceEmailAddress stringValue="${gateway.wsagAlertsSender}"/&gt;
                                &lt;L7p:Subject stringValue="CA API Gateway Routing Alert"/&gt;
                                &lt;L7p:TargetEmailAddress stringValue="${gateway.wsagAlertsICCMailingList}"/&gt;
                            &lt;/L7p:Email&gt;
                        &lt;/wsp:All&gt;
                        &lt;L7p:TrueAssertion/&gt;
                    &lt;/wsp:OneOrMore&gt;
                &lt;/wsp:ConcurrentAll&gt;
                &lt;L7p:FalseAssertion/&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="Routing Errors"/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore L7p:Enabled="false" wsp:Usage="Required"&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                &lt;L7p:Expression1 stringValue="${httpRouting.latency}"/&gt;
                &lt;L7p:Operator operatorNull="null"/&gt;
                &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item dataType="included"&gt;
                        &lt;L7p:Type variableDataType="int"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item binary="included"&gt;
                        &lt;L7p:Operator operator="LE"/&gt;
                        &lt;L7p:RightValue stringValue="${latencySLA}"/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="TGF0ZW5jeSBUaHJlc2hvbGQgRXhjZWVkZWQ6IA0KUmVxdWVzdCBzZW50IHRvICR7aHR0cFJvdXRpbmcudXJsfSB0b29rICR7aHR0cFJvdXRpbmcubGF0ZW5jeX0gdG8gcmVzcG9uZCBmb3Igb3BlcmF0aW9uICR7cmVxdWVzdC5zb2FwLm9wZXJhdGlvbn0="/&gt;
                    &lt;L7p:VariableToSet stringValue="snmpMessage"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${httpRouting.latency}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                        &lt;L7p:item dataType="included"&gt;
                            &lt;L7p:Type variableDataType="int"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item stringLength="included"&gt;
                            &lt;L7p:Max intValue="-1"/&gt;
                            &lt;L7p:Min intValue="1"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:ConcurrentAll wsp:Usage="Required"&gt;
                        &lt;L7p:Email&gt;
                            &lt;L7p:Base64message stringValue="JHtzbm1wTWVzc2FnZX0="/&gt;
                            &lt;L7p:SmtpHost stringValue="exchange.heb.com"/&gt;
                            &lt;L7p:SourceEmailAddress stringValue="${gateway.wsagAlertsSender}"/&gt;
                            &lt;L7p:Subject stringValue="WSAG Latency Alert"/&gt;
                            &lt;L7p:TargetEmailAddress stringValue="${gateway.wsagAlertsMailingList}"/&gt;
                        &lt;/L7p:Email&gt;
                        &lt;L7p:AuditDetailAssertion&gt;
                            &lt;L7p:Detail stringValue="ALERT - Latency exceeded 5s"/&gt;
                        &lt;/L7p:AuditDetailAssertion&gt;
                        &lt;L7p:SnmpTrap&gt;
                            &lt;L7p:Community stringValue="public"/&gt;
                            &lt;L7p:ErrorMessage stringValue="${snmpMessage}"/&gt;
                            &lt;L7p:Oid stringValue="1"/&gt;
                            &lt;L7p:TargetHostname stringValue="w2papw0009825.corp.heb.com"/&gt;
                        &lt;/L7p:SnmpTrap&gt;
                    &lt;/wsp:ConcurrentAll&gt;
                    &lt;L7p:TrueAssertion/&gt;
                &lt;/wsp:OneOrMore&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="Check Latency"/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                        </l7:ResourceSet>
                    </l7:Resources>
                </l7:Policy>
            </l7:Resource>
        </l7:Item>
        <l7:Item>
            <l7:Name>OfferManagerPublicAPI</l7:Name>
            <l7:Id>f678692a1f585491cc5103e3f36f5fec</l7:Id>
            <l7:Type>SERVICE</l7:Type>
            <l7:TimeStamp>2023-07-20T12:13:39.950-05:00</l7:TimeStamp>
            <l7:Resource>
                <l7:Service id="f678692a1f585491cc5103e3f36f5fec" version="3">
                    <l7:ServiceDetail folderId="f678692a1f585491cc5103e3f36f5f24" id="f678692a1f585491cc5103e3f36f5fec" version="3">
                        <l7:Name>OfferManagerPublicAPI</l7:Name>
                        <l7:Enabled>true</l7:Enabled>
                        <l7:ServiceMappings>
                            <l7:HttpMapping>
                                <l7:UrlPattern>/offermanager/v1/public*</l7:UrlPattern>
                                <l7:Verbs>
                                    <l7:Verb>POST</l7:Verb>
                                    <l7:Verb>OPTIONS</l7:Verb>
                                </l7:Verbs>
                            </l7:HttpMapping>
                        </l7:ServiceMappings>
                        <l7:Properties>
                            <l7:Property key="hasRouting">
                                <l7:BooleanValue>true</l7:BooleanValue>
                            </l7:Property>
                            <l7:Property key="internal">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                            <l7:Property key="policyRevision">
                                <l7:LongValue>5</l7:LongValue>
                            </l7:Property>
                            <l7:Property key="property.internal.portalAPIEnabled">
                                <l7:StringValue>true</l7:StringValue>
                            </l7:Property>
                            <l7:Property key="soap">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                            <l7:Property key="tracingEnabled">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                            <l7:Property key="wssProcessingEnabled">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                        </l7:Properties>
                    </l7:ServiceDetail>
                    <l7:Resources>
                        <l7:ResourceSet tag="policy">
                            <l7:Resource type="policy" version="4">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
    &lt;wsp:All wsp:Usage="Required"&gt;
        &lt;L7p:AuditAssertion&gt;
            &lt;L7p:ChangeSaveRequest booleanValue="false"/&gt;
            &lt;L7p:ChangeSaveResponse booleanValue="false"/&gt;
            &lt;L7p:Level stringValue="INFO"/&gt;
        &lt;/L7p:AuditAssertion&gt;
        &lt;L7p:ApiPortalIntegration&gt;
            &lt;L7p:ApiGroup stringValue=""/&gt;
            &lt;L7p:ApiId stringValue="58e9878d-5d11-4f51-9e76-6dd3190ae924"/&gt;
            &lt;L7p:PortalManagedApiFlag stringValue="L7p:ApiPortalManagedServiceAssertion"/&gt;
        &lt;/L7p:ApiPortalIntegration&gt;
        &lt;L7p:Include&gt;
            &lt;L7p:PolicyGuid stringValue="e29e5f47-d7f7-4e0c-872c-8925f729c385"/&gt;
            &lt;L7p:PolicyName stringValue="Portal Service Snippet Key Required - Not forward key"/&gt;
        &lt;/L7p:Include&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="----------- Set Routing Variables ---------------------------"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue="JHtnYXRld2F5LnJvdXRpbmdIb3N0Lm9mZmVyTWFuYWdlcn0="/&gt;
            &lt;L7p:VariableToSet stringValue="routingHost"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue="MzAwMDA="/&gt;
            &lt;L7p:DataType variableDataType="int"/&gt;
            &lt;L7p:VariableToSet stringValue="latencySLA"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="---------------- Define Security --------------------------------------------"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue="RW5hYmxl"/&gt;
            &lt;L7p:VariableToSet stringValue="MessageSize"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue="RW5hYmxl"/&gt;
            &lt;L7p:VariableToSet stringValue="SQLAttacks"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue="RW5hYmxl"/&gt;
            &lt;L7p:VariableToSet stringValue="CodeInjection"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue="RW5hYmxl"/&gt;
            &lt;L7p:VariableToSet stringValue="DocStructure"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="---------------------------------------------------------------------------------"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:Include&gt;
            &lt;L7p:PolicyGuid stringValue="b66f73cb-560c-4a43-9b71-debf1665a6f5"/&gt;
            &lt;L7p:PolicyName stringValue="Security Best Practices REST Service"/&gt;
        &lt;/L7p:Include&gt;
        &lt;L7p:Regex&gt;
            &lt;L7p:AssertionComment assertionComment="included"&gt;
                &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="Operation URI"/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:AutoTarget booleanValue="false"/&gt;
            &lt;L7p:CaptureVar stringValue="operationUri"/&gt;
            &lt;L7p:CaseInsensitive booleanValue="true"/&gt;
            &lt;L7p:IncludeEntireExpressionCapture booleanValue="false"/&gt;
            &lt;L7p:OtherTargetMessageVariable stringValue="request.http.uri"/&gt;
            &lt;L7p:Regex stringValue="\/v1(.*)"/&gt;
            &lt;L7p:RegexName stringValue="operationUri"/&gt;
            &lt;L7p:Replacement stringValue=""/&gt;
            &lt;L7p:Target target="OTHER"/&gt;
        &lt;/L7p:Regex&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue="L29mZmVyLW1hbmFnZXItYXBpJHtvcGVyYXRpb25Vcml9JHtyZXF1ZXN0LnVybC5xdWVyeX0="/&gt;
            &lt;L7p:VariableToSet stringValue="uri"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;L7p:HttpRoutingAssertion&gt;
                &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                &lt;L7p:ProtectedServiceUrl stringValue="${routingHost}${uri}"/&gt;
                &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                        &lt;L7p:item httpPassthroughRule="included"&gt;
                            &lt;L7p:CustomizeValue stringValue="${apiKeyRecord.label}"/&gt;
                            &lt;L7p:Name stringValue="X-Application"/&gt;
                            &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item httpPassthroughRule="included"&gt;
                            &lt;L7p:Name stringValue="omClientId"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item httpPassthroughRule="included"&gt;
                            &lt;L7p:Name stringValue="omApiKey"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                &lt;/L7p:RequestHeaderRules&gt;
                &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                &lt;/L7p:RequestParamRules&gt;
                &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                        &lt;L7p:item httpPassthroughRule="included"&gt;
                            &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                &lt;/L7p:ResponseHeaderRules&gt;
                &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
            &lt;/L7p:HttpRoutingAssertion&gt;
            &lt;L7p:Include&gt;
                &lt;L7p:PolicyGuid stringValue="9808b740-1950-442d-ab78-a84a407a18da"/&gt;
                &lt;L7p:PolicyName stringValue="Send Routing Alerts"/&gt;
            &lt;/L7p:Include&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0LmVsYXBzZWRUaW1lfQ=="/&gt;
            &lt;L7p:VariableToSet stringValue="policyRequestElapsedTime"/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:ExportVariables&gt;
            &lt;L7p:ExportedVars stringArrayValue="included"&gt;
                &lt;L7p:item stringValue="policyRequestElapsedTime"/&gt;
            &lt;/L7p:ExportedVars&gt;
        &lt;/L7p:ExportVariables&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                        </l7:ResourceSet>
                    </l7:Resources>
                </l7:Service>
            </l7:Resource>
        </l7:Item>
    </l7:References>
    <l7:Mappings>
        <l7:Mapping action="NewOrExisting" srcId="b4bff64ea3a845db60b78151a87dbfb3" srcUri="https://w2capl0055710.heb.com:8443/restman/1.0/folders/b4bff64ea3a845db60b78151a87dbfb3" type="FOLDER">
            <l7:Properties>
                <l7:Property key="FailOnNew">
                    <l7:BooleanValue>true</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:Mapping>
        <l7:Mapping action="NewOrExisting" srcId="655d6ebecd5b405fa9cb192a29d8ec55" srcUri="https://w2capl0055710.heb.com:8443/restman/1.0/policies/655d6ebecd5b405fa9cb192a29d8ec55" type="POLICY"/>
        <l7:Mapping action="NewOrExisting" srcId="bf814e308b5a7ca01522e3ee189aa7d3" srcUri="https://w2capl0055710.heb.com:8443/restman/1.0/folders/bf814e308b5a7ca01522e3ee189aa7d3" type="FOLDER">
            <l7:Properties>
                <l7:Property key="FailOnNew">
                    <l7:BooleanValue>true</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:Mapping>
        <l7:Mapping action="NewOrExisting" srcId="5f835cde51f5225f62394e8096c3e6e8" srcUri="https://w2capl0055710.heb.com:8443/restman/1.0/policies/5f835cde51f5225f62394e8096c3e6e8" type="POLICY"/>
        <l7:Mapping action="NewOrExisting" srcId="b4bff64ea3a845db60b78151a87dc16f" srcUri="https://w2capl0055710.heb.com:8443/restman/1.0/policies/b4bff64ea3a845db60b78151a87dc16f" type="POLICY"/>
        <l7:Mapping action="NewOrExisting" srcId="b4bff64ea3a845db60b78151a87dc05e" srcUri="https://w2capl0055710.heb.com:8443/restman/1.0/policies/b4bff64ea3a845db60b78151a87dc05e" type="POLICY"/>
        <l7:Mapping action="NewOrExisting" srcId="fab70e93841614f8f7afa0ce880ae52d" srcUri="https://w2capl0055710.heb.com:8443/restman/1.0/policies/fab70e93841614f8f7afa0ce880ae52d" type="POLICY"/>
        <l7:Mapping action="NewOrExisting" srcId="e0ad1669c153959e456e8c76f73bb227" srcUri="https://w2capl0055710.heb.com:8443/restman/1.0/folders/e0ad1669c153959e456e8c76f73bb227" type="FOLDER">
            <l7:Properties>
                <l7:Property key="FailOnNew">
                    <l7:BooleanValue>true</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:Mapping>
        <l7:Mapping action="NewOrExisting" srcId="7b102159b1681248185594073ef7c9d4" srcUri="https://w2capl0055710.heb.com:8443/restman/1.0/policies/7b102159b1681248185594073ef7c9d4" type="POLICY"/>
        <l7:Mapping action="NewOrExisting" srcId="cc2f26a419d076b03f43739abfbbaebd" srcUri="https://w2capl0055710.heb.com:8443/restman/1.0/policies/cc2f26a419d076b03f43739abfbbaebd" type="POLICY"/>
        <l7:Mapping action="NewOrExisting" srcId="08b77e9a36d9a0f4c92da9e60570b3a9" srcUri="https://w2capl0055710.heb.com:8443/restman/1.0/policies/08b77e9a36d9a0f4c92da9e60570b3a9" type="POLICY"/>
        <l7:Mapping action="NewOrExisting" srcId="f678692a1f585491cc5103e3f36f5f24" srcUri="https://w2capl0055710.heb.com:8443/restman/1.0/folders/f678692a1f585491cc5103e3f36f5f24" type="FOLDER">
            <l7:Properties>
                <l7:Property key="FailOnNew">
                    <l7:BooleanValue>true</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:Mapping>
        <l7:Mapping action="NewOrUpdate" srcId="f678692a1f585491cc5103e3f36f5fec" srcUri="https://w2capl0055710.heb.com:8443/restman/1.0/services/f678692a1f585491cc5103e3f36f5fec" type="SERVICE"/>
    </l7:Mappings>
</l7:Bundle>
